<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>DispersiveShallowWater ¬∑ DispersiveShallowWater.jl</title><meta name="title" content="DispersiveShallowWater ¬∑ DispersiveShallowWater.jl"/><meta property="og:title" content="DispersiveShallowWater ¬∑ DispersiveShallowWater.jl"/><meta property="twitter:title" content="DispersiveShallowWater ¬∑ DispersiveShallowWater.jl"/><meta name="description" content="Documentation for DispersiveShallowWater.jl."/><meta property="og:description" content="Documentation for DispersiveShallowWater.jl."/><meta property="twitter:description" content="Documentation for DispersiveShallowWater.jl."/><meta property="og:url" content="https://JoshuaLampert.github.io/DispersiveShallowWater.jl/stable/ref/"/><meta property="twitter:url" content="https://JoshuaLampert.github.io/DispersiveShallowWater.jl/stable/ref/"/><link rel="canonical" href="https://JoshuaLampert.github.io/DispersiveShallowWater.jl/stable/ref/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DispersiveShallowWater.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../development/">Development</a></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../ref-trixibase/">TrixiBase</a></li><li class="is-active"><a class="tocitem" href>DispersiveShallowWater</a></li></ul></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Reference</a></li><li class="is-active"><a href>DispersiveShallowWater</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>DispersiveShallowWater</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands">ÔÇõ</span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/main/docs/src/ref.md" title="Edit source on GitHub"><span class="docs-icon fa-solid">ÔÅÑ</span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="DispersiveShallowWater.jl-API"><a class="docs-heading-anchor" href="#DispersiveShallowWater.jl-API">DispersiveShallowWater.jl API</a><a id="DispersiveShallowWater.jl-API-1"></a><a class="docs-heading-anchor-permalink" href="#DispersiveShallowWater.jl-API" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.bathymetry_flat" href="#DispersiveShallowWater.bathymetry_flat"><code>DispersiveShallowWater.bathymetry_flat</code></a> ‚Äî <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">bathymetry_flat = DispersiveShallowWater.BathymetryFlat()</code></pre><p>A singleton struct indicating a flat bathymetry.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/equations.jl#L329-L333">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.boundary_condition_periodic" href="#DispersiveShallowWater.boundary_condition_periodic"><code>DispersiveShallowWater.boundary_condition_periodic</code></a> ‚Äî <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">boundary_condition_periodic = DispersiveShallowWater.BoundaryConditionPeriodic()</code></pre><p>A singleton struct indicating periodic boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/boundary_conditions.jl#L3-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.boundary_condition_reflecting" href="#DispersiveShallowWater.boundary_condition_reflecting"><code>DispersiveShallowWater.boundary_condition_reflecting</code></a> ‚Äî <span class="docstring-category">Constant</span></header><section><div><pre><code class="language-julia hljs">boundary_condition_reflecting = DispersiveShallowWater.BoundaryConditionReflecting()</code></pre><p>A singleton struct indicating reflecting boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/boundary_conditions.jl#L13-L16">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.AbstractEquations" href="#DispersiveShallowWater.AbstractEquations"><code>DispersiveShallowWater.AbstractEquations</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractEquations{NDIMS, NVARS}</code></pre><p>An abstract supertype of specific equations such as the BBM-BBM equations. The type parameters encode the number of spatial dimensions (<code>NDIMS</code>) and the number of primary variables (<code>NVARS</code>) of the physics model.</p><p>See also <a href="#DispersiveShallowWater.AbstractShallowWaterEquations"><code>AbstractShallowWaterEquations</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/equations.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.AbstractShallowWaterEquations" href="#DispersiveShallowWater.AbstractShallowWaterEquations"><code>DispersiveShallowWater.AbstractShallowWaterEquations</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractShallowWaterEquations{NDIMS, NVARS}</code></pre><p>An abstract supertype of all equation system that contain the classical shallow water equations as a subsystem, e.g., the <a href="#DispersiveShallowWater.BBMBBMEquations1D"><code>BBMBBMEquations1D</code></a>, the <a href="#DispersiveShallowWater.SvaerdKalischEquations1D"><code>SvaerdKalischEquations1D</code></a>, and the <a href="#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a>. In 1D, the shallow water equations with flat bathymetry are given by</p><p class="math-container">\[egin{aligned}
  h_t + (h v)_x &amp;= 0,\
  h v_t + rac{1}{2} g (h^2)_x + rac{1}{2} h (v^2)_x &amp;= 0,
nd{aligned}\]</p><p>where <span>$h$</span> is the <a href="#DispersiveShallowWater.waterheight"><code>waterheight</code></a>, <span>$v$</span> the <a href="#DispersiveShallowWater.velocity"><code>velocity</code></a>, and <span>$g$</span> the <a href="#DispersiveShallowWater.gravity_constant-Tuple{AbstractShallowWaterEquations}"><code>gravity_constant</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/equations.jl#L45-L62">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.AbstractSolver" href="#DispersiveShallowWater.AbstractSolver"><code>DispersiveShallowWater.AbstractSolver</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractSolver</code></pre><p>An abstract supertype of specific solvers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/solver.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.AnalysisCallback" href="#DispersiveShallowWater.AnalysisCallback"><code>DispersiveShallowWater.AnalysisCallback</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AnalysisCallback(semi; interval=0,
                       extra_analysis_errors=Symbol[],
                       extra_analysis_integrals=(),
                       io=stdout)</code></pre><p>Analyze a numerical solution every <code>interval</code> time steps. The L2- and the L‚àû-norm for each component are computed by default. Additional errors can be computed, e.g. by passing <code>extra_analysis_errors = (:conservation_error,)</code>.</p><p>Further scalar functions <code>func</code> in <code>extra_analysis_integrals</code> are applied to the numerical solution and integrated over the computational domain. Some examples for this are <a href="#DispersiveShallowWater.entropy"><code>entropy</code></a>, and <a href="#DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}"><code>energy_total</code></a>. You can also write your own function with the same signature as the examples listed above and pass it via <code>extra_analysis_integrals</code>. The computed errors and intergrals are saved for each timestep and can be obtained by calling <a href="#DispersiveShallowWater.errors-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}"><code>errors</code></a> and <a href="#DispersiveShallowWater.integrals-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}"><code>integrals</code></a>.</p><p>During the Simulation, the <code>AnalysisCallback</code> will print information to <code>io</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/callbacks_step/analysis.jl#L1-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.BBMBBMEquations1D" href="#DispersiveShallowWater.BBMBBMEquations1D"><code>DispersiveShallowWater.BBMBBMEquations1D</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">BBMBBMEquations1D(; gravity_constant, D = 1.0, eta0 = 0.0)</code></pre><p>BBM-BBM (Benjamin‚ÄìBona‚ÄìMahony) system in one spatial dimension. The equations are given by</p><p class="math-container">\[\begin{aligned}
  \eta_t + ((\eta + D)v)_x - \frac{1}{6}D^2\eta_{xxt} &amp;= 0,\\
  v_t + g\eta_x + \left(\frac{1}{2}v^2\right)_x - \frac{1}{6}D^2v_{xxt} &amp;= 0.
\end{aligned}\]</p><p>The unknown quantities of the BBM-BBM equations are the total water height <span>$\eta$</span> and the velocity <span>$v$</span>. The gravitational constant is denoted by <code>g</code> and the constant bottom topography (bathymetry) <span>$b = \eta_0 - D$</span>. The water height above the bathymetry is therefore given by <span>$h = \eta - \eta_0 + D$</span>. The BBM-BBM equations are only implemented for <span>$\eta_0 = 0$</span>.</p><p>One reference for the BBM-BBM system can be found in Bona et al. (1998). The semidiscretization implemented here conserves the mass and the energy and is developed in Ranocha et al. (2020).</p><ul><li>Jerry L. Bona, Min Chen (1998) A Boussinesq system for two-way propagation of nonlinear dispersive waves <a href="https://doi.org/10.1016/S0167-2789(97)00249-2">DOI: 10.1016/S0167-2789(97)00249-2</a></li><li>Hendrik Ranocha, Dimitrios Mitsotakis, David I. Ketcheson (2020) A Broad Class of Conservative Numerical Methods for Dispersive Wave Equations <a href="https://doi.org/10.4208/cicp.OA-2020-0119">DOI: 10.4208/cicp.OA-2020-0119</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/bbm_bbm_1d.jl#L1-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.BBMBBMVariableEquations1D" href="#DispersiveShallowWater.BBMBBMVariableEquations1D"><code>DispersiveShallowWater.BBMBBMVariableEquations1D</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">BBMBBMVariableEquations1D(; gravity_constant, eta0 = 0.0)</code></pre><p>BBM-BBM (Benjamin‚ÄìBona‚ÄìMahony) system in one spatial dimension with spatially varying bathymetry. The equations are given by</p><p class="math-container">\[\begin{aligned}
  \eta_t + ((\eta + D)v)_x - \frac{1}{6}(D^2\eta_{xt})_x &amp;= 0,\\
  v_t + g\eta_x + \left(\frac{1}{2}v^2\right)_x - \frac{1}{6}(D^2v_t)_{xx} &amp;= 0.
\end{aligned}\]</p><p>The unknown quantities of the BBM-BBM equations are the total water height <span>$\eta$</span> and the velocity <span>$v$</span>. The gravitational constant is denoted by <code>g</code> and the bottom topography (bathymetry) <span>$b = \eta_0 - D$</span>. The water height above the bathymetry is therefore given by <span>$h = \eta - \eta_0 + D$</span>. The BBM-BBM equations are only implemented for <span>$\eta_0 = 0$</span>.</p><p>One reference for the BBM-BBM system with spatially varying bathymetry can be found in Israwi et al. (2022). The semidiscretization implemented here conserves the mass and the energy, is well-balanced for the lake-at-rest state, and is developed in Lampert and Ranocha (2024).</p><ul><li>Samer Israwi, Henrik Kalisch, Theodoros Katsaounis, Dimitrios Mitsotakis (2022) A regularized shallow-water waves system with slip-wall boundary conditions in a basin: theory and numerical analysis <a href="https://doi.org/10.1088/1361-6544/ac3c29">DOI: 10.1088/1361-6544/ac3c29</a></li><li>Joshua Lampert, Hendrik Ranocha (2024) Structure-Preserving Numerical Methods for Two Nonlinear Systems of Dispersive Wave Equations <a href="https://doi.org/10.48550/arXiv.2402.16669">DOI: 10.48550/arXiv.2402.16669</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/bbm_bbm_variable_bathymetry_1d.jl#L1-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.Mesh1D" href="#DispersiveShallowWater.Mesh1D"><code>DispersiveShallowWater.Mesh1D</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Mesh1D</code></pre><p>Struct that holds the information for a simple homogeneous one-dimensional mesh.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/mesh.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.Mesh1D-Tuple{Any, Any, Any}" href="#DispersiveShallowWater.Mesh1D-Tuple{Any, Any, Any}"><code>DispersiveShallowWater.Mesh1D</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Mesh1D(xmin, xmax, N)</code></pre><p>Create a simple homogeneous one-dimensional mesh from <code>xmin</code> to <code>xmax</code> with <code>N</code> nodes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/mesh.jl#L18-L22">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.RelaxationCallback" href="#DispersiveShallowWater.RelaxationCallback"><code>DispersiveShallowWater.RelaxationCallback</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">RelaxationCallback(invariant)</code></pre><p>Use a relaxation method in time in order to exactly preserve the (nonlinear) <code>invariant</code> for a conservative semidiscretization. A possible choice for <code>invariant</code> is <code>invariant = entropy</code>.</p><p>Reference</p><ul><li>Hendrik Ranocha, Mohammed Sayyari, Lisandro Dalcin, Matteo Parsani, David I. Ketcheson (2020) Relaxation Runge‚ÄìKutta Methods: Fully-Discrete Explicit Entropy-Stable Schemes for the Compressible Euler and Navier‚ÄìStokes Equations <a href="https://doi.org/10.1137/19M1263480">DOI: 10.1137/19M1263480</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/callbacks_step/relaxation.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.Semidiscretization" href="#DispersiveShallowWater.Semidiscretization"><code>DispersiveShallowWater.Semidiscretization</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Semidiscretization</code></pre><p>A <code>struct</code> containing everything needed to describe a spatial semidiscretization of an equation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/semidiscretization.jl#L2-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.Semidiscretization-NTuple{4, Any}" href="#DispersiveShallowWater.Semidiscretization-NTuple{4, Any}"><code>DispersiveShallowWater.Semidiscretization</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Semidiscretization(mesh, equations, initial_condition, solver;
                   source_terms=nothing,
                   boundary_conditions=boundary_condition_periodic,
                   RealT=real(solver),
                   uEltype=RealT,
                   initial_cache=(tmp1 = Array{RealT}(undef, nnodes(mesh)),))</code></pre><p>Construct a semidiscretization of a PDE.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/semidiscretization.jl#L43-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.SerreGreenNaghdiEquations1D" href="#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>DispersiveShallowWater.SerreGreenNaghdiEquations1D</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SerreGreenNaghdiEquations1D(; gravity_constant, eta0 = 0.0)</code></pre><p>Serre-Green-Naghdi system in one spatial dimension. The equations for flat bathymetry are given by</p><p class="math-container">\[\begin{aligned}
  h_t + (h v)_x &amp;= 0,\\
  h v_t - \frac{1}{3} (h^3 v_{tx})_x + \frac{1}{2} g (h^2)_x + \frac{1}{2} h (v^2)_x + p_x &amp;= 0,\\
  p &amp;= \frac{1}{3} h^3 v_{x}^2 - \frac{1}{3} h^3 v v_{xx}.
\end{aligned}\]</p><p>The unknown quantities of the Serre-Green-Naghdi equations are the total water height <span>$\eta = h + b$</span> and the velocity <span>$v$</span>. The gravitational constant is denoted by <code>g</code> and the bottom topography (bathymetry) <span>$b = \eta_0 - D$</span>. The water height above the bathymetry is therefore given by <span>$h = \eta - \eta_0 + D$</span>. The Serre-Green-Naghdi equations are only implemented for <span>$\eta_0 = 0$</span>. The total water height is therefore given by <span>$\eta = h + b$</span>.</p><p>References for the Serre-Green-Naghdi system can be found in</p><ul><li>Serre (1953) Contribution √¢ l&#39;√©tude des √©coulements permanents et variables dans les canaux <a href="https://doi.org/10.1051/lhb/1953034">DOI: 10.1051/lhb/1953034</a></li><li>Green and Naghdi (1976) A derivation of equations for wave propagation in water of variable depth <a href="https://doi.org/10.1017/S0022112076002425">DOI: 10.1017/S0022112076002425</a></li></ul><p>The semidiscretization implemented here conserves</p><ul><li>the total water mass (integral of h) as a linear invariant</li><li>the total momentum (integral of h v) as a nonlinear invariant</li><li>the total energy</li></ul><p>for periodic boundary conditions, see</p><ul><li>Hendrik Ranocha and Mario Ricchiuto (2024) Structure-preserving approximations of the Serre-Green-Naghdi equations in standard and hyperbolic form <a href="https://arxiv.org/abs/2408.02665">arXiv: 2408.02665</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/serre_green_naghdi_flat_1d.jl#L1-L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.Solver" href="#DispersiveShallowWater.Solver"><code>DispersiveShallowWater.Solver</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Solver</code></pre><p>A <code>struct</code> that holds the summation by parts (SBP) operators that are used for the spatial discretization.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/solver.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.Solver-Tuple{Any, Any}" href="#DispersiveShallowWater.Solver-Tuple{Any, Any}"><code>DispersiveShallowWater.Solver</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Solver(mesh, accuracy_order)</code></pre><p>Create a solver, where the summation by parts (SBP) operators are of order <code>accuracy_order</code> and associated to the <code>mesh</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/solver.jl#L36-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.Solver-Union{Tuple{RealT}, Tuple{SummationByPartsOperators.AbstractDerivativeOperator{RealT}, Union{Nothing, AbstractMatrix{RealT}, SummationByPartsOperators.AbstractDerivativeOperator{RealT}}}} where RealT" href="#DispersiveShallowWater.Solver-Union{Tuple{RealT}, Tuple{SummationByPartsOperators.AbstractDerivativeOperator{RealT}, Union{Nothing, AbstractMatrix{RealT}, SummationByPartsOperators.AbstractDerivativeOperator{RealT}}}} where RealT"><code>DispersiveShallowWater.Solver</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">Solver(D1, D2)</code></pre><p>Create a solver, where <code>D1</code> is an <code>AbstractDerivativeOperator</code> from <a href="https://github.com/ranocha/SummationByPartsOperators.jl">SummationByPartsOperators.jl</a> of first <code>derivative_order</code> and <code>D2</code> is an <code>AbstractDerivativeOperator</code> of second <code>derivative_order</code> or an <code>AbstractMatrix</code>. It can also be <code>nothing</code> if no second derivative is used by the discretization. Both summation-by-parts operators should be associated with the same grid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/solver.jl#L50-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.SummaryCallback" href="#DispersiveShallowWater.SummaryCallback"><code>DispersiveShallowWater.SummaryCallback</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SummaryCallback(io::IO = stdout)</code></pre><p>Create and return a callback that resets the timer at the beginning of a simulation and prints the timer values at the end of the simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/callbacks_step/summary.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.SvaerdKalischEquations1D" href="#DispersiveShallowWater.SvaerdKalischEquations1D"><code>DispersiveShallowWater.SvaerdKalischEquations1D</code></a> ‚Äî <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">SvaerdKalischEquations1D(; gravity_constant, eta0 = 0.0,
                           alpha = 0.0,
                           beta = 0.2308939393939394,
                           gamma = 0.04034343434343434)</code></pre><p>Dispersive system by Sv√§rd and Kalisch in one spatial dimension with spatially varying bathymetry. The equations are given in conservative variables by</p><p class="math-container">\[\begin{aligned}
  h_t + (hv)_x &amp;= (\hat\alpha(\hat\alpha(h + b)_x)_x)_x,\\
  (hv)_t + (hv^2)_x + gh(h + b)_x &amp;= (\hat\alpha v(\hat\alpha(h + b)_x)_x)_x + (\hat\beta v_x)_{xt} + \frac{1}{2}(\hat\gamma v_x)_{xx} + \frac{1}{2}(\hat\gamma v_{xx})_x,
\end{aligned}\]</p><p>where <span>$\hat\alpha^2 = \alpha\sqrt{gD}D^2$</span>, <span>$\hat\beta = \beta D^3$</span>, <span>$\hat\gamma = \gamma\sqrt{gD}D^3$</span>. The coefficients <span>$\alpha$</span>, <span>$\beta$</span> and <span>$\gamma$</span> are provided in dimensionless form and <span>$D = \eta_0 - b$</span> is the still-water depth and <code>eta0</code> is the still-water surface (lake-at-rest). The equations can be rewritten in primitive variables as</p><p class="math-container">\[\begin{aligned}
  \eta_t + ((\eta + D)v)_x = (\hat\alpha(\hat\alpha\eta_x)_x)_x,\\
  v_t(\eta + D) - v((\eta + D)v)_x + ((\eta + D)v^2)_x + g(\eta + D)\eta_x &amp;= (\hat\alpha v(\hat\alpha\eta_x)_x)_x - v(\hat\alpha(\hat\alpha\eta_x)_x)_x + (\hat\beta v_x)_{xt} + \frac{1}{2}(\hat\gamma v_x)_{xx} + \frac{1}{2}(\hat\gamma v_{xx})_x.
\end{aligned}\]</p><p>The unknown quantities of the Sv√§rd-Kalisch equations are the total water height <span>$\eta$</span> and the velocity <span>$v$</span>. The gravitational constant is denoted by <code>g</code> and the bottom topography (bathymetry) <span>$b = \eta_0 - D$</span>. The water height above the bathymetry is therefore given by <span>$h = \eta - \eta_0 + D$</span>.</p><p><code>Sv√§rdKalischEquations1D</code> is an alias for <code>SvaerdKalischEquations1D</code>.</p><p>The equations by Sv√§rd and Kalisch are presented and analyzed in Sv√§rd and Kalisch (2023). The semidiscretization implemented here conserves the mass and the energy, is well-balanced for the lake-at-rest state, and is developed in Lampert and Ranocha (2024).</p><ul><li>Magnus Sv√§rd, Henrik Kalisch (2023) A novel energy-bounded Boussinesq model and a well-balanced and stable numerical discretization <a href="https://arxiv.org/abs/2302.09924">arXiv: 2302.09924</a></li><li>Joshua Lampert, Hendrik Ranocha (2024) Structure-Preserving Numerical Methods for Two Nonlinear Systems of Dispersive Wave Equations <a href="https://doi.org/10.48550/arXiv.2402.16669">DOI: 10.48550/arXiv.2402.16669</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/svaerd_kalisch_1d.jl#L1-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.bathymetry" href="#DispersiveShallowWater.bathymetry"><code>DispersiveShallowWater.bathymetry</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">bathymetry(q, equations)</code></pre><p>Return the bathymetry of the primitive variables <code>q</code> for a given set of <code>equations</code>.</p><p><code>q</code> is a vector of the primitive variables at a single node, i.e., a vector of the correct length <code>nvariables(equations)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/equations.jl#L176-L184">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.cons2prim" href="#DispersiveShallowWater.cons2prim"><code>DispersiveShallowWater.cons2prim</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">cons2prim(u, equations)</code></pre><p>Convert the conserved variables <code>u</code> to the primitive variables for a given set of <code>equations</code>. <code>u</code> is a vector type of the correct length <code>nvariables(equations)</code>. Notice the function doesn&#39;t include any error checks for the purpose of efficiency, so please make sure your input is correct. The inverse conversion is performed by <a href="#DispersiveShallowWater.prim2cons"><code>prim2cons</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/equations.jl#L84-L92">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.convergence_test-Tuple{Module, AbstractString, Any}" href="#DispersiveShallowWater.convergence_test-Tuple{Module, AbstractString, Any}"><code>DispersiveShallowWater.convergence_test</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">convergence_test([mod::Module=Main,] example::AbstractString, iterations; io::IO = stdout, kwargs...)
convergence_test([mod::Module=Main,] example::AbstractString, Ns::AbstractVector; io::IO = stdout, kwargs...)</code></pre><p>Run multiple simulations using the setup given in <code>example</code> and compute the experimental order of convergence (EOC) in the <span>$L^2$</span> and <span>$L^\infty$</span> norm. If <code>iterations</code> is passed as integer, in each iteration, the resolution of the respective mesh will be doubled. If <code>Ns</code> is passed as vector, the simulations will be run for each value of <code>Ns</code>. Additional keyword arguments <code>kwargs...</code> and the optional module <code>mod</code> are passed directly to <a href="../ref-trixibase/#TrixiBase.trixi_include-Tuple{Module, AbstractString}"><code>trixi_include</code></a>.</p><p>Adjusted from <a href="https://github.com/trixi-framework/Trixi.jl">Trixi.jl</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/util.jl#L55-L67">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.default_analysis_errors-Tuple{DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.default_analysis_errors-Tuple{DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.default_analysis_errors</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">default_analysis_errors(equations)</code></pre><p>Default analysis errors used by the <a href="#DispersiveShallowWater.AnalysisCallback"><code>AnalysisCallback</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/equations.jl#L313-L317">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.default_analysis_integrals-Tuple{DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.default_analysis_integrals-Tuple{DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.default_analysis_integrals</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">default_analysis_integrals(equations)</code></pre><p>Default analysis integrals used by the <a href="#DispersiveShallowWater.AnalysisCallback"><code>AnalysisCallback</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/equations.jl#L320-L324">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.default_example-Tuple{}" href="#DispersiveShallowWater.default_example-Tuple{}"><code>DispersiveShallowWater.default_example</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">default_example()</code></pre><p>Return the path to an example that can be used to quickly see DispersiveShallowWater.jl in action. See also <a href="#DispersiveShallowWater.examples_dir-Tuple{}"><code>examples_dir</code></a> and <a href="#DispersiveShallowWater.get_examples-Tuple{}"><code>get_examples</code></a>.</p><p>Copied from <a href="https://github.com/trixi-framework/Trixi.jl">Trixi.jl</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/util.jl#L38-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.discharge-Tuple{Any, DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.discharge-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.discharge</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">discharge(q, equations)</code></pre><p>See <a href="#DispersiveShallowWater.momentum-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>momentum</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/equations.jl#L150-L154">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.eachvariable-Tuple{DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.eachvariable-Tuple{DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.eachvariable</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">eachvariable(equations::AbstractEquations)</code></pre><p>Return an iterator over the indices that specify the location in relevant data structures for the variables in <code>equations</code>. In particular, not the variables themselves are returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/equations.jl#L15-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}" href="#DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}"><code>DispersiveShallowWater.energy_total</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">energy_total(q, equations)</code></pre><p>Return the total energy of the primitive variables <code>q</code> for a given set of <code>equations</code>. For all <a href="#DispersiveShallowWater.AbstractShallowWaterEquations"><code>AbstractShallowWaterEquations</code></a>, the total energy is given by the sum of the kinetic and potential energy of the shallow water subsystem, i.e.,</p><p class="math-container">\[\frac{1}{2} h v^2 + \frac{1}{2} g \eta^2\]</p><p>in 1D, where <span>$h$</span> is the <a href="#DispersiveShallowWater.waterheight"><code>waterheight</code></a>, <span>$\eta = h + b$</span> the <a href="#DispersiveShallowWater.waterheight_total"><code>waterheight_total</code></a>, <span>$v$</span> the <a href="#DispersiveShallowWater.velocity"><code>velocity</code></a>, and <span>$g$</span> the <a href="#DispersiveShallowWater.gravity_constant-Tuple{AbstractShallowWaterEquations}"><code>gravity_constant</code></a>.</p><p><code>q</code> is a vector of the primitive variables at a single node, i.e., a vector of the correct length <code>nvariables(equations)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/equations.jl#L215-L231">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.energy_total_modified-Tuple{Any, AbstractShallowWaterEquations, Any}" href="#DispersiveShallowWater.energy_total_modified-Tuple{Any, AbstractShallowWaterEquations, Any}"><code>DispersiveShallowWater.energy_total_modified</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">energy_total_modified(q_global, equations::AbstractShallowWaterEquations, cache)</code></pre><p>Return the modified total energy of the primitive variables <code>q_global</code> for the <code>equations</code>. This modified total energy is a conserved quantity and can contain additional terms compared to the usual <a href="#DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}"><code>energy_total</code></a>. For example, for the <a href="#DispersiveShallowWater.SvaerdKalischEquations1D"><code>SvaerdKalischEquations1D</code></a> and the <a href="#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a>, it contains additional terms depending on the derivative of the velocity <span>$v_x$</span> modeling non-hydrostatic contributions.</p><p><code>q_global</code> is a vector of the primitive variables at ALL nodes. <code>cache</code> needs to hold the SBP operators used by the <code>solver</code> if non-hydrostatic terms are present.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/equations.jl#L242-L256">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.energy_total_modified-Tuple{Any, SerreGreenNaghdiEquations1D, Any}" href="#DispersiveShallowWater.energy_total_modified-Tuple{Any, SerreGreenNaghdiEquations1D, Any}"><code>DispersiveShallowWater.energy_total_modified</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">energy_total_modified(q_global, equations::SerreGreenNaghdiEquations1D, cache)</code></pre><p>Return the modified total energy of the primitive variables <code>q_global</code> for the <a href="#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a>. It contains an additional term containing a derivative compared to the usual <a href="#DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}"><code>energy_total</code></a> modeling non-hydrostatic contributions. The <a href="#DispersiveShallowWater.energy_total_modified-Tuple{Any, AbstractShallowWaterEquations, Any}"><code>energy_total_modified</code></a> is a conserved quantity (for periodic boundary conditions).</p><p>For a <a href="#DispersiveShallowWater.bathymetry_flat"><code>bathymetry_flat</code></a> the total energy is given by</p><p class="math-container">\[\frac{1}{2} g h^2 + \frac{1}{2} h v^2 + \frac{1}{6} h^3 v_x^2.\]</p><p><code>q_global</code> is a vector of the primitive variables at ALL nodes. <code>cache</code> needs to hold the SBP operators used by the <code>solver</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/serre_green_naghdi_flat_1d.jl#L414-L431">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.energy_total_modified-Tuple{Any, SvaerdKalischEquations1D, Any}" href="#DispersiveShallowWater.energy_total_modified-Tuple{Any, SvaerdKalischEquations1D, Any}"><code>DispersiveShallowWater.energy_total_modified</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">energy_total_modified(q_global, equations::SvaerdKalischEquations1D, cache)</code></pre><p>Return the modified total energy of the primitive variables <code>q_global</code> for the <code>SvaerdKalischEquations1D</code>. It contains an additional term containing a derivative compared to the usual <code>energy_total</code>. The <code>energy_total_modified</code> is a conserved quantity of the Sv√§rd-Kalisch equations.</p><p><code>q_global</code> is a vector of the primitive variables at ALL nodes. <code>cache</code> needs to hold the first-derivative SBP operator <code>D1</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/svaerd_kalisch_1d.jl#L336-L346">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.entropy" href="#DispersiveShallowWater.entropy"><code>DispersiveShallowWater.entropy</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">entropy(q, equations)</code></pre><p>Return the entropy of the primitive variables <code>q</code> for a given set of <code>equations</code>. For all <a href="#DispersiveShallowWater.AbstractShallowWaterEquations"><code>AbstractShallowWaterEquations</code></a>, the <code>entropy</code> is just the <a href="#DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}"><code>energy_total</code></a>.</p><p><code>q</code> is a vector of the primitive variables at a single node, i.e., a vector of the correct length <code>nvariables(equations)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/equations.jl#L187-L196">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.entropy_modified-Tuple{Any, AbstractShallowWaterEquations, Any}" href="#DispersiveShallowWater.entropy_modified-Tuple{Any, AbstractShallowWaterEquations, Any}"><code>DispersiveShallowWater.entropy_modified</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">entropy_modified(q_global, equations::AbstractShallowWaterEquations, cache)</code></pre><p>Alias for <a href="#DispersiveShallowWater.energy_total_modified-Tuple{Any, AbstractShallowWaterEquations, Any}"><code>energy_total_modified</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/equations.jl#L271-L275">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.errors-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}" href="#DispersiveShallowWater.errors-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}"><code>DispersiveShallowWater.errors</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">errors(analysis_callback)</code></pre><p>Return the computed errors for each timestep as a named tuple. The shape of each entry is (nvariables, ntimesteps).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/callbacks_step/analysis.jl#L117-L122">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.examples_dir-Tuple{}" href="#DispersiveShallowWater.examples_dir-Tuple{}"><code>DispersiveShallowWater.examples_dir</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">examples_dir()</code></pre><p>Return the directory where the example files provided with DispersiveShallowWater.jl are located. If DispersiveShallowWater is installed as a regular package (with <code>]add DispersiveShallowWater</code>), these files are read-only and should <em>not</em> be modified. To find out which files are available, use, e.g., <code>readdir</code>.</p><p>Copied from <a href="https://github.com/trixi-framework/Trixi.jl">Trixi.jl</a>.</p><p><strong>Examples</strong></p><pre><code class="language- hljs">readdir(examples_dir())</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/util.jl#L1-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.get_examples-Tuple{}" href="#DispersiveShallowWater.get_examples-Tuple{}"><code>DispersiveShallowWater.get_examples</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_examples()</code></pre><p>Return a list of all examples that are provided by DispersiveShallowWater.jl. See also <a href="#DispersiveShallowWater.examples_dir-Tuple{}"><code>examples_dir</code></a> and <a href="#DispersiveShallowWater.default_example-Tuple{}"><code>default_example</code></a>.</p><p>Copied from <a href="https://github.com/trixi-framework/Trixi.jl">Trixi.jl</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/util.jl#L17-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.get_name-Tuple{DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.get_name-Tuple{DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.get_name</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_name(equations::AbstractEquations)</code></pre><p>Return the canonical, human-readable name for the given system of equations.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; DispersiveShallowWater.get_name(BBMBBMEquations1D(gravity_constant=1.0))
&quot;BBMBBMEquations1D&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/equations.jl#L23-L32">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.gravity_constant-Tuple{AbstractShallowWaterEquations}" href="#DispersiveShallowWater.gravity_constant-Tuple{AbstractShallowWaterEquations}"><code>DispersiveShallowWater.gravity_constant</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gravity_constant(equations::AbstractShallowWaterEquations)</code></pre><p>Return the gravity constant <span>$g$</span> for a given set of <code>equations</code>. See also <a href="#DispersiveShallowWater.AbstractShallowWaterEquations"><code>AbstractShallowWaterEquations</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/equations.jl#L205-L210">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, BBMBBMEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, BBMBBMEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_convergence_test</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initial_condition_convergence_test(x, t, equations::BBMBBMEquations1D, mesh)</code></pre><p>A travelling-wave solution used for convergence tests in a periodic domain.</p><p>For details see Example 5 in Section 3 from (here adapted for dimensional equations):</p><ul><li>Min Chen (1997) Exact Traveling-Wave Solutions to Bidirectional Wave Equations <a href="https://doi.org/10.1023/A:1026667903256">DOI: 10.1023/A:1026667903256</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/bbm_bbm_1d.jl#L39-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, BBMBBMVariableEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, BBMBBMVariableEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_convergence_test</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initial_condition_convergence_test(x, t, equations::BBMBBMVariableEquations1D, mesh)</code></pre><p>A travelling-wave solution used for convergence tests in a periodic domain. The bathymetry is constant.</p><p>For details see Example 5 in Section 3 from (here adapted for dimensional equations):</p><ul><li>Min Chen (1997) Exact Traveling-Wave Solutions to Bidirectional Wave Equations <a href="https://doi.org/10.1023/A:1026667903256">DOI: 10.1023/A:1026667903256</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/bbm_bbm_variable_bathymetry_1d.jl#L39-L49">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, SerreGreenNaghdiEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, SerreGreenNaghdiEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_convergence_test</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initial_condition_convergence_test(x, t, equations::SerreGreenNaghdiEquations1D, mesh)</code></pre><p>A soliton solution used for convergence tests in a periodic domain.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/serre_green_naghdi_flat_1d.jl#L56-L60">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_dingemans-Tuple{Any, Any, BBMBBMVariableEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_dingemans-Tuple{Any, Any, BBMBBMVariableEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_dingemans</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initial_condition_dingemans(x, t, equations::BBMBBMVariableEquations1D, mesh)</code></pre><p>The initial condition that uses the dispersion relation of the Euler equations to approximate waves generated by a wave maker as it is done by experiments of Dingemans. The topography is a trapezoidal.</p><div class="admonition is-warning"><header class="admonition-header">Translation of water height</header><div class="admonition-body"><p>The initial condition for the water height is translated to be around 0, which is needed for the simulation because the <code>BBMBBMVariableEquations1D</code> are only implemented for <span>$ta_0 = 0$</span>.</p></div></div><p>References:</p><ul><li>Magnus Sv√§rd, Henrik Kalisch (2023) A novel energy-bounded Boussinesq model and a well-balanced and stable numerical discretization <a href="https://arxiv.org/abs/2302.09924">arXiv: 2302.09924</a></li><li>Maarten W. Dingemans (1994) Comparison of computations with Boussinesq-like models and laboratory measurements <a href="https://repository.tudelft.nl/islandora/object/uuid:c2091d53-f455-48af-a84b-ac86680455e9/datastream/OBJ/download">link</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/bbm_bbm_variable_bathymetry_1d.jl#L154-L173">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_dingemans-Tuple{Any, Any, SvaerdKalischEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_dingemans-Tuple{Any, Any, SvaerdKalischEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_dingemans</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initial_condition_dingemans(x, t, equations::SvaerdKalischEquations1D, mesh)</code></pre><p>The initial condition that uses the dispersion relation of the Euler equations to approximate waves generated by a wave maker as it is done by experiments of Dingemans. The topography is a trapezoidal. It is assumed that <code>equations.eta0 = 0.8</code>.</p><p>References:</p><ul><li>Magnus Sv√§rd, Henrik Kalisch (2023) A novel energy-bounded Boussinesq model and a well-balanced and stable numerical discretization <a href="https://arxiv.org/abs/2302.09924">arXiv: 2302.09924</a></li><li>Maarten W. Dingemans (1994) Comparison of computations with Boussinesq-like models and laboratory measurements <a href="https://repository.tudelft.nl/islandora/object/uuid:c2091d53-f455-48af-a84b-ac86680455e9/datastream/OBJ/download">link</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/svaerd_kalisch_1d.jl#L57-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMBBMEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMBBMEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_manufactured</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initial_condition_manufactured(x, t, equations::BBMBBMEquations1D, mesh)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMBBMEquations1D}"><code>source_terms_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/bbm_bbm_1d.jl#L62-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMBBMVariableEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMBBMVariableEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_manufactured</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initial_condition_manufactured(x, t, equations::BBMBBMVariableEquations1D, mesh)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMBBMEquations1D}"><code>source_terms_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/bbm_bbm_variable_bathymetry_1d.jl#L66-L70">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, SvaerdKalischEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, SvaerdKalischEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_manufactured</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initial_condition_manufactured(x, t, equations::SvaerdKalischEquations1D, mesh)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMBBMEquations1D}"><code>source_terms_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/svaerd_kalisch_1d.jl#L97-L101">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, BBMBBMEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, BBMBBMEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_manufactured_reflecting</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initial_condition_manufactured_reflecting(x, t, equations::BBMBBMEquations1D, mesh)</code></pre><p>A smooth manufactured solution for reflecting boundary conditions in combination with <a href="#DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, BBMBBMEquations1D}"><code>source_terms_manufactured_reflecting</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/bbm_bbm_1d.jl#L100-L105">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, BBMBBMVariableEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, BBMBBMVariableEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_manufactured_reflecting</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">initial_condition_manufactured_reflecting(x, t, equations::BBMBBMVariableEquations1D, mesh)</code></pre><p>A smooth manufactured solution for reflecting boundary conditions in combination with <a href="#DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, BBMBBMEquations1D}"><code>source_terms_manufactured_reflecting</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/bbm_bbm_variable_bathymetry_1d.jl#L113-L118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.integrals-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}" href="#DispersiveShallowWater.integrals-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}"><code>DispersiveShallowWater.integrals</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">integrals(analysis_callback)</code></pre><p>Return the computed integrals for each timestep as a named tuple.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/callbacks_step/analysis.jl#L136-L140">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.momentum-Tuple{Any, DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.momentum-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.momentum</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">momentum(q, equations)</code></pre><p>Return the momentum/discharge of the primitive variables <code>q</code> for a given set of <code>equations</code>, i.e., the <a href="#DispersiveShallowWater.waterheight"><code>waterheight</code></a> times the <a href="#DispersiveShallowWater.velocity"><code>velocity</code></a>.</p><p><code>q</code> is a vector of the primitive variables at a single node, i.e., a vector of the correct length <code>nvariables(equations)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/equations.jl#L135-L143">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.prim2cons" href="#DispersiveShallowWater.prim2cons"><code>DispersiveShallowWater.prim2cons</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">prim2cons(q, equations)</code></pre><p>Convert the primitive variables <code>q</code> to the conserved variables for a given set of <code>equations</code>. <code>q</code> is a vector type of the correct length <code>nvariables(equations)</code>. Notice the function doesn&#39;t include any error checks for the purpose of efficiency, so please make sure your input is correct. The inverse conversion is performed by <a href="#DispersiveShallowWater.cons2prim"><code>cons2prim</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/equations.jl#L73-L81">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.prim2prim-Tuple{Any, DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.prim2prim-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.prim2prim</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">prim2prim(q, equations)</code></pre><p>Return the primitive variables <code>q</code>. While this function is as trivial as <code>identity</code>, it is also as useful.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/equations.jl#L65-L70">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.semidiscretize-Tuple{Semidiscretization, Any}" href="#DispersiveShallowWater.semidiscretize-Tuple{Semidiscretization, Any}"><code>DispersiveShallowWater.semidiscretize</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">semidiscretize(semi::Semidiscretization, tspan)</code></pre><p>Wrap the semidiscretization <code>semi</code> as an ODE problem in the time interval <code>tspan</code> that can be passed to <code>solve</code> from the <a href="https://diffeq.sciml.ai/latest/">SciML ecosystem</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/semidiscretization.jl#L199-L204">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMBBMEquations1D}" href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMBBMEquations1D}"><code>DispersiveShallowWater.source_terms_manufactured</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">source_terms_manufactured(q, x, t, equations::BBMBBMEquations1D, mesh)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMBBMEquations1D, Any}"><code>initial_condition_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/bbm_bbm_1d.jl#L75-L79">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMBBMVariableEquations1D}" href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMBBMVariableEquations1D}"><code>DispersiveShallowWater.source_terms_manufactured</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">source_terms_manufactured(q, x, t, equations::BBMBBMVariableEquations1D, mesh)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMBBMEquations1D, Any}"><code>initial_condition_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/bbm_bbm_variable_bathymetry_1d.jl#L80-L84">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, SvaerdKalischEquations1D}" href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, SvaerdKalischEquations1D}"><code>DispersiveShallowWater.source_terms_manufactured</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">source_terms_manufactured(q, x, t, equations::SvaerdKalischEquations1D, mesh)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMBBMEquations1D, Any}"><code>initial_condition_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/svaerd_kalisch_1d.jl#L112-L116">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, BBMBBMEquations1D}" href="#DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, BBMBBMEquations1D}"><code>DispersiveShallowWater.source_terms_manufactured_reflecting</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">source_terms_manufactured_reflecting(q, x, t, equations::BBMBBMEquations1D, mesh)</code></pre><p>A smooth manufactured solution for reflecting boundary conditions in combination with <a href="#DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, BBMBBMEquations1D, Any}"><code>initial_condition_manufactured_reflecting</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/bbm_bbm_1d.jl#L114-L119">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, BBMBBMVariableEquations1D}" href="#DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, BBMBBMVariableEquations1D}"><code>DispersiveShallowWater.source_terms_manufactured_reflecting</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">source_terms_manufactured_reflecting(q, x, t, equations::BBMBBMVariableEquations1D, mesh)</code></pre><p>A smooth manufactured solution for reflecting boundary conditions in combination with <a href="#DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, BBMBBMEquations1D, Any}"><code>initial_condition_manufactured_reflecting</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/bbm_bbm_variable_bathymetry_1d.jl#L128-L133">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.still_water_surface-Tuple{Any, AbstractShallowWaterEquations}" href="#DispersiveShallowWater.still_water_surface-Tuple{Any, AbstractShallowWaterEquations}"><code>DispersiveShallowWater.still_water_surface</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">still_water_surface(q, equations::AbstractShallowWaterEquations)</code></pre><p>Return the still water surface <span>$\eta_0$</span> (lake at rest) for a given set of <code>equations</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/equations.jl#L159-L164">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.tstops-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}" href="#DispersiveShallowWater.tstops-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}"><code>DispersiveShallowWater.tstops</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">tstops(analysis_callback)</code></pre><p>Return the time values that correspond to the saved values of the <a href="#DispersiveShallowWater.errors-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}"><code>errors</code></a> and <a href="#DispersiveShallowWater.integrals-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}"><code>integrals</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/callbacks_step/analysis.jl#L104-L108">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.varnames" href="#DispersiveShallowWater.varnames"><code>DispersiveShallowWater.varnames</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">varnames(conversion_function, equations)</code></pre><p>Return the list of variable names when applying <code>conversion_function</code> to the conserved variables associated to <code>equations</code>. Common choices of the <code>conversion_function</code> are <a href="#DispersiveShallowWater.prim2prim-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>prim2prim</code></a> and <a href="#DispersiveShallowWater.prim2cons"><code>prim2cons</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/equations.jl#L35-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.velocity" href="#DispersiveShallowWater.velocity"><code>DispersiveShallowWater.velocity</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">velocity(q, equations)</code></pre><p>Return the velocity of the primitive variables <code>q</code> for a given set of <code>equations</code>.</p><p><code>q</code> is a vector of the primitive variables at a single node, i.e., a vector of the correct length <code>nvariables(equations)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/equations.jl#L122-L130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.waterheight" href="#DispersiveShallowWater.waterheight"><code>DispersiveShallowWater.waterheight</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">waterheight(q, equations)</code></pre><p>Return the waterheight of the primitive variables <code>q</code> for a given set of <code>equations</code>, i.e., the waterheight above the bathymetry.</p><p><code>q</code> is a vector of the primitive variables at a single node, i.e., a vector of the correct length <code>nvariables(equations)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/equations.jl#L109-L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.waterheight_total" href="#DispersiveShallowWater.waterheight_total"><code>DispersiveShallowWater.waterheight_total</code></a> ‚Äî <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">waterheight_total(q, equations)</code></pre><p>Return the total waterheight of the primitive variables <code>q</code> for a given set of <code>equations</code>, i.e., the <a href="#DispersiveShallowWater.waterheight"><code>waterheight</code></a> plus the <a href="#DispersiveShallowWater.bathymetry"><code>bathymetry</code></a>.</p><p><code>q</code> is a vector of the primitive variables at a single node, i.e., a vector of the correct length <code>nvariables(equations)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/equations/equations.jl#L95-L104">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SummationByPartsOperators.grid-Tuple{Semidiscretization}" href="#SummationByPartsOperators.grid-Tuple{Semidiscretization}"><code>SummationByPartsOperators.grid</code></a> ‚Äî <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">grid(semi)</code></pre><p>Get the grid of a semidiscretization.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/semidiscretization.jl#L114-L118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.@autoinfiltrate" href="#DispersiveShallowWater.@autoinfiltrate"><code>DispersiveShallowWater.@autoinfiltrate</code></a> ‚Äî <span class="docstring-category">Macro</span></header><section><div><pre><code class="language-julia hljs">@autoinfiltrate
@autoinfiltrate condition::Bool</code></pre><p>Invoke the <code>@infiltrate</code> macro of the package Infiltrator.jl to create a breakpoint for ad-hoc interactive debugging in the REPL. If the optional argument <code>condition</code> is given, the breakpoint is only enabled if <code>condition</code> evaluates to <code>true</code>.</p><p>As opposed to using <code>Infiltrator.@infiltrate</code> directly, this macro does not require Infiltrator.jl to be added as a dependency to DispersiveShallowWater.jl. As a bonus, the macro will also attempt to load the Infiltrator module if it has not yet been loaded manually.</p><p>Note: For this macro to work, the Infiltrator.jl package needs to be installed in your current Julia environment stack.</p><p>See also: <a href="https://github.com/JuliaDebug/Infiltrator.jl">Infiltrator.jl</a></p><div class="admonition is-warning"><header class="admonition-header">Internal use only</header><div class="admonition-body"><p>Please note that this macro is intended for internal use only. It is <em>not</em> part of the public API of DispersiveShallowWater.jl, and it thus can altered (or be removed) at any time without it being considered a breaking change.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JoshuaLampert/DispersiveShallowWater.jl/blob/036361494a2485a1a9c2036f5b2873b779cb75f5/src/util.jl#L194-L215">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ref-trixibase/">¬´ TrixiBase</a><a class="docs-footer-nextpage" href="../license/">License ¬ª</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Thursday 15 August 2024 08:09">Thursday 15 August 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
