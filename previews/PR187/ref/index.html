<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>DispersiveShallowWater · DispersiveShallowWater.jl</title><meta name="title" content="DispersiveShallowWater · DispersiveShallowWater.jl"/><meta property="og:title" content="DispersiveShallowWater · DispersiveShallowWater.jl"/><meta property="twitter:title" content="DispersiveShallowWater · DispersiveShallowWater.jl"/><meta name="description" content="Documentation for DispersiveShallowWater.jl."/><meta property="og:description" content="Documentation for DispersiveShallowWater.jl."/><meta property="twitter:description" content="Documentation for DispersiveShallowWater.jl."/><meta property="og:url" content="https://NumericalMathematics.github.io/DispersiveShallowWater.jl/stable/ref/"/><meta property="twitter:url" content="https://NumericalMathematics.github.io/DispersiveShallowWater.jl/stable/ref/"/><link rel="canonical" href="https://NumericalMathematics.github.io/DispersiveShallowWater.jl/stable/ref/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DispersiveShallowWater.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../overview/">Overview</a></li><li><a class="tocitem" href="../dispersion/">Dispersion</a></li><li><a class="tocitem" href="../development/">Development</a></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../ref-trixibase/">TrixiBase</a></li><li class="is-active"><a class="tocitem" href>DispersiveShallowWater</a><ul class="internal"><li><a class="tocitem" href="#Equations"><span>Equations</span></a></li><li><a class="tocitem" href="#Linear-dispersion-relations"><span>Linear dispersion relations</span></a></li><li><a class="tocitem" href="#Mesh"><span>Mesh</span></a></li><li><a class="tocitem" href="#Boundary-conditions"><span>Boundary conditions</span></a></li><li><a class="tocitem" href="#Solver"><span>Solver</span></a></li><li><a class="tocitem" href="#Semidiscretization"><span>Semidiscretization</span></a></li><li><a class="tocitem" href="#Callbacks"><span>Callbacks</span></a></li><li><a class="tocitem" href="#Utilities"><span>Utilities</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../changelog/">Changelog</a></li><li><a class="tocitem" href="../contributing/">Contributing</a></li><li><a class="tocitem" href="../code_of_conduct/">Code of Conduct</a></li><li><a class="tocitem" href="../license/">License</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Reference</a></li><li class="is-active"><a href>DispersiveShallowWater</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>DispersiveShallowWater</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/main/docs/src/ref.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="DispersiveShallowWater.jl-API"><a class="docs-heading-anchor" href="#DispersiveShallowWater.jl-API">DispersiveShallowWater.jl API</a><a id="DispersiveShallowWater.jl-API-1"></a><a class="docs-heading-anchor-permalink" href="#DispersiveShallowWater.jl-API" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.DispersiveShallowWater" href="#DispersiveShallowWater.DispersiveShallowWater"><code>DispersiveShallowWater.DispersiveShallowWater</code></a> — <span class="docstring-category">Module</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DispersiveShallowWater</code></pre><p><strong>DispersiveShallowWater.jl</strong> is a Julia package that implements structure-preserving numerical methods for dispersive shallow water models. It provides provably conservative, entropy-conserving, and well-balanced numerical schemes for some dispersive shallow water models.</p><p>The semidiscretizations are based on summation-by-parts (SBP) operators, which are implemented in <a href="https://github.com/ranocha/SummationByPartsOperators.jl">SummationByPartsOperators.jl</a>. To obtain fully discrete schemes, the time integration methods from <a href="https://github.com/SciML/OrdinaryDiffEq.jl">OrdinaryDiffEq.jl</a> are used to solve the resulting ordinary differential equations. Fully discrete entropy-conservative methods can be obtained by using the relaxation method provided by DispersiveShallowWater.jl.</p><p>See also: <a href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl">DispersiveShallowWater.jl</a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/DispersiveShallowWater.jl#L1-L15">source</a></section></article><h2 id="Equations"><a class="docs-heading-anchor" href="#Equations">Equations</a><a id="Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Equations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.BBMEquation1D" href="#DispersiveShallowWater.BBMEquation1D"><code>DispersiveShallowWater.BBMEquation1D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BBMEquation1D(; gravity, D = 1.0, eta0 = 0.0, split_form = true)</code></pre><p>BBM (Benjamin–Bona–Mahony) equation in one spatial dimension. The equation is given by</p><p class="math-container">\[\begin{aligned}
  \eta_t + \sqrt{gD}\eta_x + \frac{3}{2}\sqrt{\frac{g}{D}}\eta\eta_x - \frac{1}{6}D^2\eta_{xxt} &amp;= 0.
\end{aligned}\]</p><p>The unknown quantity of the BBM equation is the total water height <span>$\eta$</span>. The gravitational acceleration <code>gravity</code> is denoted by <span>$g$</span> and the constant bottom topography (bathymetry) <span>$b = \eta_0 - D$</span>, where <span>$\eta_0$</span> is the constant still-water surface and <span>$D$</span> the still-water depth. The water height above the bathymetry is therefore given by <span>$h = \eta - \eta_0 + D$</span>. The BBM equation is only implemented for <span>$\eta_0 = 0$</span>.</p><p>The equations only support a flat bathymetry.</p><p>The BBM equation is first described in Benjamin, Bona, and Mahony (1972). The semidiscretization implemented here is developed in Ranocha, Mitsotakis, and Ketcheson (2020) for <code>split_form = true</code> and in Linders, Ranocha, and Birken (2023) for <code>split_form = false</code>. If <code>split_form</code> is <code>true</code>, a split form in the semidiscretization is used, which conserves</p><ul><li>the total water mass (integral of <span>$h$</span>) as a linear invariant</li><li>a quadratic invariant (integral of <span>$1/2\eta(\eta - 1/6D^2\eta_{xx})$</span> or for periodic boundary conditions equivalently <span>$1/2(\eta^2 + 1/6D^2\eta_x^2)$</span>), which is called here <a href="#DispersiveShallowWater.energy_total_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>energy_total_modified</code></a> (and <a href="#DispersiveShallowWater.entropy_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>entropy_modified</code></a>) because it contains derivatives of the solution</li></ul><p>for periodic boundary conditions. If <code>split_form</code> is <code>false</code> the semidiscretization conserves</p><ul><li>the total water mass (integral of <span>$h$</span>) as a linear invariant</li><li>the Hamiltonian (integral of <span>$1/4\sqrt{g/D}\eta^3 + 1/2\sqrt{gD}\eta^2$</span>) (see <a href="#DispersiveShallowWater.hamiltonian-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>hamiltonian</code></a>)</li></ul><p>for periodic boundary conditions.</p><ul><li>Thomas B. Benjamin, Jerry L. Bona and John J. Mahony (1972) Model equations for long waves in nonlinear dispersive systems <a href="https://doi.org/10.1098/rsta.1972.0032">DOI: 10.1098/rsta.1972.0032</a></li><li>Hendrik Ranocha, Dimitrios Mitsotakis and David I. Ketcheson (2020) A Broad Class of Conservative Numerical Methods for Dispersive Wave Equations <a href="https://doi.org/10.4208/cicp.OA-2020-0119">DOI: 10.4208/cicp.OA-2020-0119</a></li><li>Viktor Linders, Hendrik Ranocha and Philipp Birken (2023) Resolving entropy growth from iterative methods <a href="https://doi.org/10.1007/s10543-023-00992-w">DOI: 10.1007/s10543-023-00992-w</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/bbm_1d.jl#L1-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.energy_total_modified!-Tuple{Any, Any, BBMEquation1D, Any}" href="#DispersiveShallowWater.energy_total_modified!-Tuple{Any, Any, BBMEquation1D, Any}"><code>DispersiveShallowWater.energy_total_modified!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">energy_total_modified!(e, q_global, equations::BBMEquation1D, cache)</code></pre><p>Return the modified total energy <code>e</code> of the primitive variables <code>q_global</code> for the <a href="#DispersiveShallowWater.BBMEquation1D"><code>BBMEquation1D</code></a>. The <code>energy_total_modified</code> is a conserved quantity (for periodic boundary conditions).</p><p>It is given by</p><p class="math-container">\[\frac{1}{2} \eta(\eta - \frac{1}{6}D^2\eta_{xx}).\]</p><p><code>q_global</code> is a vector of the primitive variables at ALL nodes. <code>cache</code> needs to hold the SBP operators used by the <code>solver</code>.</p><p>See also <a href="#DispersiveShallowWater.energy_total_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>energy_total_modified</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/bbm_1d.jl#L193-L209">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.hamiltonian!-Tuple{Any, Any, BBMEquation1D, Any}" href="#DispersiveShallowWater.hamiltonian!-Tuple{Any, Any, BBMEquation1D, Any}"><code>DispersiveShallowWater.hamiltonian!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hamiltonian!(H, q_global, equations::BBMEquation1D, cache)</code></pre><p>Return the Hamiltonian <code>H</code> of the primitive variables <code>q_global</code> for the <a href="#DispersiveShallowWater.BBMEquation1D"><code>BBMEquation1D</code></a>. The Hamiltonian is given by</p><p class="math-container">\[\frac{1}{4}\sqrt{\frac{g}{D}}\eta^3 + \frac{1}{2}\sqrt{gD}\eta^2.\]</p><p><code>q_global</code> is a vector of the primitive variables at ALL nodes.</p><p>See also <a href="#DispersiveShallowWater.hamiltonian-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>hamiltonian</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/bbm_1d.jl#L226-L238">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, BBMEquation1D, Any}" href="#DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, BBMEquation1D, Any}"><code>DispersiveShallowWater.initial_condition_convergence_test</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_convergence_test(x, t, equations::BBMEquation1D, mesh)</code></pre><p>A travelling-wave solution used for convergence tests in a periodic domain, here generalized for dimensional variables.</p><p>See section 4.1.3 in (there is an error in paper: it should be <code>sech^2</code> instead of <code>cosh</code>):</p><ul><li>Hendrik Ranocha, Dimitrios Mitsotakis and David I. Ketcheson (2020) A Broad Class of Conservative Numerical Methods for Dispersive Wave Equations <a href="https://doi.org/10.4208/cicp.OA-2020-0119">DOI: 10.4208/cicp.OA-2020-0119</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/bbm_1d.jl#L56-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMEquation1D, Any}" href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMEquation1D, Any}"><code>DispersiveShallowWater.initial_condition_manufactured</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_manufactured(x, t, equations::BBMEquation1D, mesh)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMEquation1D}"><code>source_terms_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/bbm_1d.jl#L81-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMEquation1D}" href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMEquation1D}"><code>DispersiveShallowWater.source_terms_manufactured</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">source_terms_manufactured(q, x, t, equations::BBMEquation1D, mesh)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMEquation1D, Any}"><code>initial_condition_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/bbm_1d.jl#L93-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.BBMBBMEquations1D" href="#DispersiveShallowWater.BBMBBMEquations1D"><code>DispersiveShallowWater.BBMBBMEquations1D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">BBMBBMEquations1D(; bathymetry_type = bathymetry_variable,
                  gravity, eta0 = 0.0)</code></pre><p>BBM-BBM (Benjamin–Bona–Mahony) system in one spatial dimension. The equations for flat bathymetry are given by</p><p class="math-container">\[\begin{aligned}
  \eta_t + ((\eta + D)v)_x - \frac{1}{6}D^2\eta_{xxt} &amp;= 0,\\
  v_t + g\eta_x + \left(\frac{1}{2}v^2\right)_x - \frac{1}{6}D^2v_{xxt} &amp;= 0.
\end{aligned}\]</p><p>The unknown quantities of the BBM-BBM equations are the total water height <span>$\eta$</span> and the velocity <span>$v$</span>. The gravitational acceleration <code>gravity</code> is denoted by <span>$g$</span> and the constant bottom topography (bathymetry) <span>$b = \eta_0 - D$</span>. The water height above the bathymetry is therefore given by <span>$h = \eta - \eta_0 + D$</span>. The BBM-BBM equations are only implemented for <span>$\eta_0 = 0$</span>.</p><p>Two types of <code>bathymetry_type</code> are supported:</p><ul><li><a href="#DispersiveShallowWater.bathymetry_flat"><code>bathymetry_flat</code></a>: flat bathymetry (typically <span>$b = 0$</span> everywhere)</li><li><a href="#DispersiveShallowWater.bathymetry_variable"><code>bathymetry_variable</code></a>: general variable bathymetry</li></ul><p>For the general case of variable vathymetry the BBM-BBM equations are</p><p class="math-container">\[\begin{aligned}
  \eta_t + ((\eta + D)v)_x - \frac{1}{6}(D^2\eta_{xt})_x &amp;= 0,\\
  v_t + g\eta_x + \left(\frac{1}{2}v^2\right)_x - \frac{1}{6}(D^2v_t)_{xx} &amp;= 0.
\end{aligned}\]</p><p>One reference for the BBM-BBM system can be found in Bona et al. (1998). The semidiscretization implemented here was developed for flat bathymetry in Ranocha et al. (2020) and generalized for a variable bathymetry in Lampert and Ranocha (2024). It conserves</p><ul><li>the total water mass (integral of <span>$h$</span>) as a linear invariant</li><li>the total velocity (integral of <span>$v$</span>) as a linear invariant for flat bathymetry</li><li>the total energy</li></ul><p>for periodic boundary conditions (see Lampert, Ranocha). For reflecting boundary conditions, the semidiscretization conserves</p><ul><li>the total water (integral of <span>$h$</span>) as a linear invariant</li><li>the total energy.</li></ul><p>Additionally, it is well-balanced for the lake-at-rest stationary solution, see Lampert and Ranocha (2024).</p><ul><li>Jerry L. Bona, Min Chen (1998) A Boussinesq system for two-way propagation of nonlinear dispersive waves <a href="https://doi.org/10.1016/S0167-2789(97)00249-2">DOI: 10.1016/S0167-2789(97)00249-2</a></li><li>Hendrik Ranocha, Dimitrios Mitsotakis, David I. Ketcheson (2020) A Broad Class of Conservative Numerical Methods for Dispersive Wave Equations <a href="https://doi.org/10.4208/cicp.OA-2020-0119">DOI: 10.4208/cicp.OA-2020-0119</a></li><li>Joshua Lampert, Hendrik Ranocha (2024) Structure-Preserving Numerical Methods for Two Nonlinear Systems of Dispersive Wave Equations <a href="https://doi.org/10.48550/arXiv.2402.16669">DOI: 10.48550/arXiv.2402.16669</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/bbm_bbm_1d.jl#L1-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, BBMBBMEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, BBMBBMEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_convergence_test</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_convergence_test(x, t, equations::BBMBBMEquations1D, mesh)</code></pre><p>A traveling-wave solution used for convergence tests in a periodic domain. The bathymetry is constant.</p><p>For details see Example 5 in Section 3 from (here adapted for dimensional equations):</p><ul><li>Min Chen (1997) Exact Traveling-Wave Solutions to Bidirectional Wave Equations <a href="https://doi.org/10.1023/A:1026667903256">DOI: 10.1023/A:1026667903256</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/bbm_bbm_1d.jl#L67-L77">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_dingemans-Tuple{Any, Any, BBMBBMEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_dingemans-Tuple{Any, Any, BBMBBMEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_dingemans</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_dingemans(x, t, equations::BBMBBMEquations1D, mesh)</code></pre><p>The initial condition that uses the dispersion relation of the Euler equations to approximate waves generated by a wave maker as it is done by experiments of Dingemans. The topography is a trapezoidal.</p><div class="admonition is-warning"><header class="admonition-header">Translation of water height</header><div class="admonition-body"><p>The initial condition for the water height is translated to be around 0, which is needed for the simulation because the <code>BBMBBMEquations1D</code> are only implemented for <span>$\eta_0 = 0$</span>.</p></div></div><p>References:</p><ul><li>Magnus Svärd, Henrik Kalisch (2023) A novel energy-bounded Boussinesq model and a well-balanced and stable numerical discretization <a href="https://arxiv.org/abs/2302.09924">arXiv: 2302.09924</a></li><li>Maarten W. Dingemans (1994) Comparison of computations with Boussinesq-like models and laboratory measurements <a href="https://repository.tudelft.nl/islandora/object/uuid:c2091d53-f455-48af-a84b-ac86680455e9/datastream/OBJ/download">link</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/bbm_bbm_1d.jl#L226-L245">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMBBMEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMBBMEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_manufactured</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_manufactured(x, t, equations::BBMBBMEquations1D, mesh)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMEquation1D}"><code>source_terms_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/bbm_bbm_1d.jl#L92-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, BBMBBMEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, BBMBBMEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_manufactured_reflecting</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_manufactured_reflecting(x, t, equations::BBMBBMEquations1D, mesh)</code></pre><p>A smooth manufactured solution for reflecting boundary conditions in combination with <a href="#DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, BBMBBMEquations1D}"><code>source_terms_manufactured_reflecting</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/bbm_bbm_1d.jl#L163-L168">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMBBMEquations1D}" href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMBBMEquations1D}"><code>DispersiveShallowWater.source_terms_manufactured</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">source_terms_manufactured(q, x, t, equations::BBMBBMEquations1D, mesh)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMEquation1D, Any}"><code>initial_condition_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/bbm_bbm_1d.jl#L110-L114">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, BBMBBMEquations1D}" href="#DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, BBMBBMEquations1D}"><code>DispersiveShallowWater.source_terms_manufactured_reflecting</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">source_terms_manufactured_reflecting(q, x, t, equations::BBMBBMEquations1D, mesh)</code></pre><p>A smooth manufactured solution for reflecting boundary conditions in combination with <a href="#DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, BBMBBMEquations1D, Any}"><code>initial_condition_manufactured_reflecting</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/bbm_bbm_1d.jl#L182-L187">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.bathymetry_flat" href="#DispersiveShallowWater.bathymetry_flat"><code>DispersiveShallowWater.bathymetry_flat</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bathymetry_flat = DispersiveShallowWater.BathymetryFlat()</code></pre><p>A singleton struct indicating a flat bathymetry.</p><p>See also <a href="#DispersiveShallowWater.bathymetry_mild_slope"><code>bathymetry_mild_slope</code></a> and <a href="#DispersiveShallowWater.bathymetry_variable"><code>bathymetry_variable</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L509-L515">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.bathymetry_mild_slope" href="#DispersiveShallowWater.bathymetry_mild_slope"><code>DispersiveShallowWater.bathymetry_mild_slope</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bathymetry_mild_slope = DispersiveShallowWater.BathymetryMildSlope()</code></pre><p>A singleton struct indicating a variable bathymetry with mild-slope approximation. Typically, this means that some terms like <span>$b_x^2$</span> are neglected.</p><p>See also <a href="#DispersiveShallowWater.bathymetry_flat"><code>bathymetry_flat</code></a> and <a href="#DispersiveShallowWater.bathymetry_variable"><code>bathymetry_variable</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L519-L527">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.bathymetry_variable" href="#DispersiveShallowWater.bathymetry_variable"><code>DispersiveShallowWater.bathymetry_variable</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bathymetry_variable = DispersiveShallowWater.BathymetryVariable()</code></pre><p>A singleton struct indicating a variable bathymetry (without mild-slope approximation).</p><p>See also <a href="#DispersiveShallowWater.bathymetry_flat"><code>bathymetry_flat</code></a> and <a href="#DispersiveShallowWater.bathymetry_mild_slope"><code>bathymetry_mild_slope</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L531-L538">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.AbstractEquations" href="#DispersiveShallowWater.AbstractEquations"><code>DispersiveShallowWater.AbstractEquations</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractEquations{NDIMS, NVARS}</code></pre><p>An abstract supertype of specific equations such as the BBM-BBM equations. The type parameters encode the number of spatial dimensions (<code>NDIMS</code>) and the number of primary variables (<code>NVARS</code>) of the physics model.</p><p>See also <a href="#DispersiveShallowWater.AbstractShallowWaterEquations"><code>AbstractShallowWaterEquations</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.AbstractShallowWaterEquations" href="#DispersiveShallowWater.AbstractShallowWaterEquations"><code>DispersiveShallowWater.AbstractShallowWaterEquations</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractShallowWaterEquations{NDIMS, NVARS}</code></pre><p>An abstract supertype of all equation system that contain the classical shallow water equations as a subsystem, e.g., the <a href="#DispersiveShallowWater.BBMBBMEquations1D"><code>BBMBBMEquations1D</code></a>, the <a href="#DispersiveShallowWater.SvaerdKalischEquations1D"><code>SvaerdKalischEquations1D</code></a>, and the <a href="#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a>. In 1D, the shallow water equations with flat bathymetry are given by</p><p class="math-container">\[\begin{aligned}
  h_t + (h v)_x &amp;= 0,\\
  h v_t + \frac{1}{2} g (h^2)_x + \frac{1}{2} h (v^2)_x &amp;= 0,
\end{aligned}\]</p><p>where <span>$h$</span> is the <a href="#DispersiveShallowWater.waterheight-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>waterheight</code></a>, <span>$v$</span> the <a href="#DispersiveShallowWater.velocity-Tuple{Any, AbstractShallowWaterEquations}"><code>velocity</code></a>, and <span>$g$</span> the <a href="#DispersiveShallowWater.gravity-Tuple{DispersiveShallowWater.AbstractEquations}"><code>gravity</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L25-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.bathymetry-Tuple{Any, DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.bathymetry-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.bathymetry</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bathymetry(q, equations)</code></pre><p>Return the bathymetry of the primitive variables <code>q</code> for a given set of <code>equations</code>.</p><p><code>q</code> is a vector of the primitive variables at a single node, i.e., a vector of the correct length <code>nvariables(equations)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L230-L238">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.cons2prim-Tuple{Any, AbstractShallowWaterEquations}" href="#DispersiveShallowWater.cons2prim-Tuple{Any, AbstractShallowWaterEquations}"><code>DispersiveShallowWater.cons2prim</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">cons2prim(u, equations)</code></pre><p>Convert the conserved variables <code>u</code> to the primitive variables for a given set of <code>equations</code>. <code>u</code> is a vector type of the correct length <code>nvariables(equations)</code>. Notice the function doesn&#39;t include any error checks for the purpose of efficiency, so please make sure your input is correct. The inverse conversion is performed by <a href="#DispersiveShallowWater.prim2cons-Tuple{Any, AbstractShallowWaterEquations}"><code>prim2cons</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L114-L122">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.default_analysis_errors-Tuple{DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.default_analysis_errors-Tuple{DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.default_analysis_errors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">default_analysis_errors(equations)</code></pre><p>Default analysis errors used by the <a href="#DispersiveShallowWater.AnalysisCallback"><code>AnalysisCallback</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L437-L441">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.default_analysis_integrals-Tuple{DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.default_analysis_integrals-Tuple{DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.default_analysis_integrals</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">default_analysis_integrals(equations)</code></pre><p>Default analysis integrals used by the <a href="#DispersiveShallowWater.AnalysisCallback"><code>AnalysisCallback</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L444-L448">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.discharge-Tuple{Any, DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.discharge-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.discharge</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">discharge(q, equations)</code></pre><p>See <a href="#DispersiveShallowWater.momentum-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>momentum</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L205-L209">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.eachvariable-Tuple{DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.eachvariable-Tuple{DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.eachvariable</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eachvariable(equations::AbstractEquations)</code></pre><p>Return an iterator over the indices that specify the location in relevant data structures for the variables in <code>equations</code>. In particular, not the variables themselves are returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L15-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}" href="#DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}"><code>DispersiveShallowWater.energy_total</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">energy_total(q, equations)</code></pre><p>Return the total energy of the primitive variables <code>q</code> for a given set of <code>equations</code>. For all <a href="#DispersiveShallowWater.AbstractShallowWaterEquations"><code>AbstractShallowWaterEquations</code></a>, the total energy is given by the sum of the kinetic and potential energy of the shallow water subsystem, i.e.,</p><p class="math-container">\[\frac{1}{2} h v^2 + \frac{1}{2} g \eta^2\]</p><p>in 1D, where <span>$h$</span> is the <a href="#DispersiveShallowWater.waterheight-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>waterheight</code></a>, <span>$\eta = h + b$</span> the <a href="#DispersiveShallowWater.waterheight_total-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>waterheight_total</code></a>, <span>$v$</span> the <a href="#DispersiveShallowWater.velocity-Tuple{Any, AbstractShallowWaterEquations}"><code>velocity</code></a>, and <span>$g$</span> the <a href="#DispersiveShallowWater.gravity-Tuple{DispersiveShallowWater.AbstractEquations}"><code>gravity</code></a>.</p><p><code>q</code> is a vector of the primitive variables at a single node, i.e., a vector of the correct length <code>nvariables(equations)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L268-L284">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.energy_total_modified!-Tuple{Any, Any, DispersiveShallowWater.AbstractEquations, Any}" href="#DispersiveShallowWater.energy_total_modified!-Tuple{Any, Any, DispersiveShallowWater.AbstractEquations, Any}"><code>DispersiveShallowWater.energy_total_modified!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">energy_total_modified!(e, q_global, equations, cache)</code></pre><p>In-place version of <a href="#DispersiveShallowWater.energy_total_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>energy_total_modified</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L338-L342">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.energy_total_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}" href="#DispersiveShallowWater.energy_total_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>DispersiveShallowWater.energy_total_modified</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">energy_total_modified(q_global, equations, cache)</code></pre><p>Return the modified total energy of the primitive variables <code>q_global</code> for the <code>equations</code>. This modified total energy is a conserved quantity and can contain additional terms compared to the usual <a href="#DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}"><code>energy_total</code></a>. For example, for the <a href="#DispersiveShallowWater.SvaerdKalischEquations1D"><code>SvaerdKalischEquations1D</code></a> and the <a href="#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a>, it contains additional terms depending on the derivative of the velocity <span>$v_x$</span> modeling non-hydrostatic contributions. For equations which are not <code>AbstractShallowWaterEquations</code>, the modified total energy does not have to be an extension of the usual <a href="#DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}"><code>energy_total</code></a> and does not have to be related to a physical energy. However, it is still a conserved quantity for appropriate boundary conditions and may contain derivatives of the solution.</p><p><code>q_global</code> is a vector of the primitive variables at ALL nodes. <code>cache</code> needs to hold the SBP operators used by the <code>solver</code> if non-hydrostatic terms are present.</p><p>Internally, this function allocates a vector for the output and calls <a href="#DispersiveShallowWater.energy_total_modified!-Tuple{Any, Any, BBMEquation1D, Any}"><code>DispersiveShallowWater.energy_total_modified!</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L311-L332">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.entropy-Tuple{Any, AbstractShallowWaterEquations}" href="#DispersiveShallowWater.entropy-Tuple{Any, AbstractShallowWaterEquations}"><code>DispersiveShallowWater.entropy</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">entropy(q, equations)</code></pre><p>Return the entropy of the primitive variables <code>q</code> for a given set of <code>equations</code>. For all <a href="#DispersiveShallowWater.AbstractShallowWaterEquations"><code>AbstractShallowWaterEquations</code></a>, the <code>entropy</code> is just the <a href="#DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}"><code>energy_total</code></a>.</p><p><code>q</code> is a vector of the primitive variables at a single node, i.e., a vector of the correct length <code>nvariables(equations)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L294-L303">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.entropy_modified!-NTuple{4, Any}" href="#DispersiveShallowWater.entropy_modified!-NTuple{4, Any}"><code>DispersiveShallowWater.entropy_modified!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">entropy_modified!(e, q_global, equations, cache)</code></pre><p>In-place version of <a href="#DispersiveShallowWater.entropy_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>entropy_modified</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L367-L371">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.entropy_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}" href="#DispersiveShallowWater.entropy_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>DispersiveShallowWater.entropy_modified</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">entropy_modified(q_global, equations, cache)</code></pre><p>Alias for <a href="#DispersiveShallowWater.energy_total_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>energy_total_modified</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L357-L361">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.get_name-Tuple{DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.get_name-Tuple{DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.get_name</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_name(equations::AbstractEquations)</code></pre><p>Return the canonical, human-readable name for the given system of equations.</p><p><strong>Examples</strong></p><pre><code class="language-julia-repl hljs">julia&gt; DispersiveShallowWater.get_name(BBMBBMEquations1D(gravity=1.0))
&quot;BBMBBMEquations1D-BathymetryVariable&quot;</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L45-L54">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.gravity-Tuple{DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.gravity-Tuple{DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.gravity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">gravity(equations)</code></pre><p>Return the gravitational acceleration <span>$g$</span> for a given set of <code>equations</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L259-L263">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.hamiltonian-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}" href="#DispersiveShallowWater.hamiltonian-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>DispersiveShallowWater.hamiltonian</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">hamiltonian(q_global, equations, cache)</code></pre><p>Return the Hamiltonian of the primitive variables <code>q_global</code> for the <code>equations</code>. The Hamiltonian is a conserved quantity and may contain derivatives of the solution.</p><p><code>q_global</code> is a vector of the primitive variables at ALL nodes. <code>cache</code> needs to hold the SBP operators used by the <code>solver</code> if non-hydrostatic terms are present.</p><p>Internally, this function allocates a vector for the output and calls <a href="#DispersiveShallowWater.hamiltonian!-Tuple{Any, Any, BBMEquation1D, Any}"><code>DispersiveShallowWater.hamiltonian!</code></a>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This function is not necessarily implemented for all equations. See <a href="#DispersiveShallowWater.hamiltonian!-Tuple{Any, Any, BBMEquation1D, Any}"><code>DispersiveShallowWater.hamiltonian!</code></a> for further details of equations supporting it.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L380-L398">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.hyperbolic_approximation_limit-Tuple{DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.hyperbolic_approximation_limit-Tuple{DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.hyperbolic_approximation_limit</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DispersiveShallowWater.hyperbolic_approximation_limit(equations)</code></pre><p>If the equations are a hyperbolic approximation of another set of equations, return the equations of the limit system. Otherwise, return the input equations.</p><p>See also <a href="#DispersiveShallowWater.is_hyperbolic_appproximation-Tuple{DispersiveShallowWater.AbstractEquations}"><code>is_hyperbolic_appproximation</code></a> and <a href="#DispersiveShallowWater.prim2phys-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>prim2phys</code></a>.</p><div class="admonition is-info"><header class="admonition-header">Implementation details</header><div class="admonition-body"><p>This function is mostly used for some internal dispatch. For example, it allows to return a reduced set of variables from initial conditions for hyperbolic approximations.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L468-L480">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_dingemans-Tuple{Any, Any, AbstractShallowWaterEquations, Any}" href="#DispersiveShallowWater.initial_condition_dingemans-Tuple{Any, Any, AbstractShallowWaterEquations, Any}"><code>DispersiveShallowWater.initial_condition_dingemans</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_dingemans(x, t, equations::AbstractShallowWaterEquations, mesh)</code></pre><p>The initial condition that uses the dispersion relation of the Euler equations to approximate waves generated by a wave maker as it is done by experiments of Dingemans. The topography is a trapezoidal. It is assumed that <code>equations.eta0 = 0.8</code>.</p><p>References:</p><ul><li>Magnus Svärd, Henrik Kalisch (2023) A novel energy-bounded Boussinesq model and a well-balanced and stable numerical discretization <a href="https://arxiv.org/abs/2302.09924">arXiv: 2302.09924</a></li><li>Maarten W. Dingemans (1994) Comparison of computations with Boussinesq-like models and laboratory measurements <a href="https://repository.tudelft.nl/islandora/object/uuid:c2091d53-f455-48af-a84b-ac86680455e9/datastream/OBJ/download">link</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L605-L619">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_discontinuous_well_balancedness-Tuple{Any, Any, AbstractShallowWaterEquations, Any}" href="#DispersiveShallowWater.initial_condition_discontinuous_well_balancedness-Tuple{Any, Any, AbstractShallowWaterEquations, Any}"><code>DispersiveShallowWater.initial_condition_discontinuous_well_balancedness</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_discontinuous_well_balancedness(x, t, equations::AbstractShallowWaterEquations, mesh)</code></pre><p>Setup a truly discontinuous bottom topography function for this academic lake-at-rest test case of well-balancedness, i.e. <code>eta</code> is constant and <code>v</code> is zero everywhere. The error for this lake-at-rest test case <code>∫|η-η₀|</code> should be around machine roundoff.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L647-L654">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.is_hyperbolic_appproximation-Tuple{DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.is_hyperbolic_appproximation-Tuple{DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.is_hyperbolic_appproximation</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DispersiveShallowWater.is_hyperbolic_appproximation(equations)</code></pre><p>Returns <code>Val{true}()</code> if the equations are a hyperbolic approximation of another set of equations and <code>Val{false}()</code> otherwise (default). For example, the <a href="#DispersiveShallowWater.HyperbolicSerreGreenNaghdiEquations1D"><code>HyperbolicSerreGreenNaghdiEquations1D</code></a> are a hyperbolic approximation of the <a href="#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a>.</p><p>See also <a href="#DispersiveShallowWater.hyperbolic_approximation_limit-Tuple{DispersiveShallowWater.AbstractEquations}"><code>hyperbolic_approximation_limit</code></a> and <a href="#DispersiveShallowWater.prim2phys-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>prim2phys</code></a>.</p><div class="admonition is-info"><header class="admonition-header">Implementation details</header><div class="admonition-body"><p>This function is mostly used for some internal dispatch. For example, it allows to return a reduced set of variables from initial conditions for hyperbolic approximations.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L451-L465">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.lake_at_rest_error-Tuple{Any, DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.lake_at_rest_error-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.lake_at_rest_error</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">lake_at_rest_error(q, equations)</code></pre><p>Calculate the error for the &quot;lake-at-rest&quot; test case where the <a href="#DispersiveShallowWater.waterheight_total-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>waterheight_total</code></a> <span>$\eta = h + b$</span> should be a constant value over time (given by the value <span>$\eta_0$</span> passed to the <code>equations</code> when constructing them).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L245-L252">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.momentum-Tuple{Any, DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.momentum-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.momentum</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">momentum(q, equations)</code></pre><p>Return the momentum/discharge of the primitive variables <code>q</code> for a given set of <code>equations</code>, i.e., the <a href="#DispersiveShallowWater.waterheight-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>waterheight</code></a> times the <a href="#DispersiveShallowWater.velocity-Tuple{Any, AbstractShallowWaterEquations}"><code>velocity</code></a>.</p><p><code>q</code> is a vector of the primitive variables at a single node, i.e., a vector of the correct length <code>nvariables(equations)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L190-L198">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.prim2cons-Tuple{Any, AbstractShallowWaterEquations}" href="#DispersiveShallowWater.prim2cons-Tuple{Any, AbstractShallowWaterEquations}"><code>DispersiveShallowWater.prim2cons</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prim2cons(q, equations)</code></pre><p>Convert the primitive variables <code>q</code> to the conserved variables for a given set of <code>equations</code>. <code>q</code> is a vector type of the correct length <code>nvariables(equations)</code>. Notice the function doesn&#39;t include any error checks for the purpose of efficiency, so please make sure your input is correct. The inverse conversion is performed by <a href="#DispersiveShallowWater.cons2prim-Tuple{Any, AbstractShallowWaterEquations}"><code>cons2prim</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L88-L96">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.prim2phys-Tuple{Any, DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.prim2phys-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.prim2phys</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prim2phys(q, equations)</code></pre><p>Convert the primitive variables <code>q</code> to the physically meaningful variables for a given set of <code>equations</code>. By default, this is the same as <a href="#DispersiveShallowWater.prim2prim-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>prim2prim</code></a> for most equations. However, some equations like the <a href="#DispersiveShallowWater.HyperbolicSerreGreenNaghdiEquations1D"><code>HyperbolicSerreGreenNaghdiEquations1D</code></a> return a reduced set of variables since they are a hyperbolic approximation of another set of equations (in this case the <a href="#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a>).</p><p>See also <a href="#DispersiveShallowWater.is_hyperbolic_appproximation-Tuple{DispersiveShallowWater.AbstractEquations}"><code>is_hyperbolic_appproximation</code></a> and <a href="#DispersiveShallowWater.hyperbolic_approximation_limit-Tuple{DispersiveShallowWater.AbstractEquations}"><code>hyperbolic_approximation_limit</code></a>.</p><p><code>q</code> is a vector type of the correct length <code>nvariables(equations)</code>. Notice the function doesn&#39;t include any error checks for the purpose of efficiency, so please make sure your input is correct.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L483-L499">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.prim2prim-Tuple{Any, DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.prim2prim-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.prim2prim</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prim2prim(q, equations)</code></pre><p>Return the primitive variables <code>q</code>. While this function is as trivial as <code>identity</code>, it is also as useful.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L77-L82">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.still_water_surface-Tuple{Any, DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.still_water_surface-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.still_water_surface</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">still_water_surface(q, equations)</code></pre><p>Return the still water surface <span>$\eta_0$</span> (lake at rest) for a given set of <code>equations</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L214-L219">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.varnames" href="#DispersiveShallowWater.varnames"><code>DispersiveShallowWater.varnames</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">varnames(conversion_function, equations)</code></pre><p>Return the list of variable names when applying <code>conversion_function</code> to the primitive variables associated to <code>equations</code>. Common choices of the <code>conversion_function</code> are <a href="#DispersiveShallowWater.prim2prim-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>prim2prim</code></a>, <a href="#DispersiveShallowWater.prim2cons-Tuple{Any, AbstractShallowWaterEquations}"><code>prim2cons</code></a>, and <a href="#DispersiveShallowWater.prim2phys-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>prim2phys</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L67-L74">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.velocity-Tuple{Any, AbstractShallowWaterEquations}" href="#DispersiveShallowWater.velocity-Tuple{Any, AbstractShallowWaterEquations}"><code>DispersiveShallowWater.velocity</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">velocity(q, equations)</code></pre><p>Return the velocity of the primitive variables <code>q</code> for a given set of <code>equations</code>.</p><p><code>q</code> is a vector of the primitive variables at a single node, i.e., a vector of the correct length <code>nvariables(equations)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L175-L183">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.waterheight-Tuple{Any, DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.waterheight-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.waterheight</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">waterheight(q, equations)</code></pre><p>Return the waterheight of the primitive variables <code>q</code> for a given set of <code>equations</code>, i.e., the waterheight <span>$h$</span> above the bathymetry <span>$b$</span>.</p><p><code>q</code> is a vector of the primitive variables at a single node, i.e., a vector of the correct length <code>nvariables(equations)</code>.</p><p>See also <a href="#DispersiveShallowWater.waterheight_total-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>waterheight_total</code></a>, <a href="#DispersiveShallowWater.bathymetry-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>bathymetry</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L158-L168">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.waterheight_total-Tuple{Any, DispersiveShallowWater.AbstractEquations}" href="#DispersiveShallowWater.waterheight_total-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>DispersiveShallowWater.waterheight_total</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">waterheight_total(q, equations)</code></pre><p>Return the total waterheight of the primitive variables <code>q</code> for a given set of <code>equations</code>, i.e., the <a href="#DispersiveShallowWater.waterheight-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>waterheight</code></a> <span>$h$</span> plus the <a href="#DispersiveShallowWater.bathymetry-Tuple{Any, DispersiveShallowWater.AbstractEquations}"><code>bathymetry</code></a> <span>$b$</span>.</p><p><code>q</code> is a vector of the primitive variables at a single node, i.e., a vector of the correct length <code>nvariables(equations)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/equations.jl#L142-L151">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.HyperbolicSerreGreenNaghdiEquations1D" href="#DispersiveShallowWater.HyperbolicSerreGreenNaghdiEquations1D"><code>DispersiveShallowWater.HyperbolicSerreGreenNaghdiEquations1D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">HyperbolicSerreGreenNaghdiEquations1D(; bathymetry_type = bathymetry_mild_slope,
                                      gravity,
                                      eta0 = 0.0,
                                      lambda)</code></pre><p>Hyperbolic approximation of the Serre-Green-Naghdi system in one spatial dimension. The equations for flat bathymetry are given by</p><p class="math-container">\[\begin{aligned}
  h_t + (h v)_x &amp;= 0,\\
  h v_t + \frac{1}{2} g (h^2)_x + \frac{1}{2} h (v^2)_x
    + \biggl( \frac{\lambda}{3} H (1 - H / h) \biggr)_x &amp;= 0,\\
  h w_t + h v w_x &amp;= \lambda (1 - H / h),\\
  H_t + H_x u &amp;= w.
\end{aligned}\]</p><p>The unknown quantities of the hyperbolized Serre-Green-Naghdi equations are the total water height <span>$\eta = h + b$</span> and the velocity <span>$v$</span>. The gravitational acceleration <code>gravity</code> is denoted by <span>$g$</span> and the bottom topography (bathymetry) <span>$b = \eta_0 - D$</span>. The water height above the bathymetry is therefore given by <span>$h = \eta - \eta_0 + D$</span>. The total water height is therefore given by <span>$\eta = h + b$</span>.</p><p>There are two additional variables <span>$w \approx -h v_x$</span> and <span>$H \approx h$</span> compared to the <a href="#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a>. In the original papers of Gavrilyuk et al., the variable <span>$H$</span> is called <span>$\eta$</span>. Here, we use <span>$\eta$</span> for the total water height and <span>$H$</span> for auxiliary variable introduced in the hyperbolic approximation.</p><div class="admonition is-info"><header class="admonition-header">Initial conditions</header><div class="admonition-body"><p>The <code>HyperbolicSerreGreenNaghdiEquations1D</code> allow two options for specifying initial conditions:</p><ol><li>Returning the full set of variables <code>q = (η, v, D, w, H)</code></li><li>Returning a reduced set of variables <code>q = (η, v, D)</code> as required for the limit system <a href="#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a> of the hyperbolic approximation. The remaining variables <code>w</code> and <code>H</code> are initialized using the default initialization <span>$w \approx -h v_x$</span> and <span>$H \approx h$</span> using the derivative operator of the <code>solver</code>.</li></ol></div></div><p>The relaxation parameter <code>lambda</code> (<span>$\lambda$</span>) introduced to obtain this hyperbolic approximation of the <a href="#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a> influences the stiffness of the system. For <span>$\lambda \to \infty$</span>, the hyperbolic Serre-Green-Naghdi equations converge (at least formally) to the original <a href="#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a>. However, the wave speeds of the hyperbolic system increase with increasing <span>$\lambda$</span>, so that explicit time integration methods become more expensive.</p><p>Two types of <code>bathymetry_type</code> are supported:</p><ul><li><a href="#DispersiveShallowWater.bathymetry_flat"><code>bathymetry_flat</code></a>: flat bathymetry (typically <span>$b = 0$</span> everywhere)</li><li><a href="#DispersiveShallowWater.bathymetry_mild_slope"><code>bathymetry_mild_slope</code></a>: variable bathymetry with mild-slope approximation</li></ul><p>For the mild-slope approximation, the Serre-Green-Naghdi equations are</p><p class="math-container">\[\begin{aligned}
  h_t + (h v)_x &amp;= 0,\\
  h v_t + \frac{1}{2} g (h^2)_x + \frac{1}{2} h (v^2)_x
    + \biggl( \frac{\lambda}{3} H (1 - H / h) \biggr)_x
    + \biggl( g h + \frac{\lambda}{2} (1 - H / h) \biggr) b_x &amp;= 0,\\
  h w_t + h v w_x &amp;= \lambda (1 - H / h),\\
  H_t + H_x u + \frac{3}{2} b_x v &amp;= w.
\end{aligned}\]</p><p>References for the hyperbolized Serre-Green-Naghdi system can be found in</p><ul><li>Favrie and Gavrilyuk. A rapid numerical method for solving Serre-Green-Naghdi equations describing long free surface gravity waves <a href="https://doi.org/10.1088/1361-6544/aa712d">DOI: 10.1088/1361-6544/aa712d</a></li><li>Busto, Dumbser, Escalante, Favrie, and Gavrilyuk. On High Order ADER Discontinuous Galerkin Schemes for First Order Hyperbolic Reformulations of Nonlinear Dispersive Systems <a href="https://doi.org/10.1007/s10915-021-01429-8">DOI: 10.1007/s10915-021-01429-8</a></li></ul><p>The semidiscretization implemented here conserves</p><ul><li>the total water mass (integral of <span>$h$</span>) as a linear invariant</li><li>the total modified energy</li></ul><p>for periodic boundary conditions (see Ranocha and Ricchiuto (2024)). Additionally, it is well-balanced for the lake-at-rest stationary solution, see</p><ul><li>Hendrik Ranocha and Mario Ricchiuto (2024) Structure-preserving approximations of the Serre-Green-Naghdi equations in standard and hyperbolic form <a href="https://arxiv.org/abs/2408.02665">arXiv: 2408.02665</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/hyperbolic_serre_green_naghdi_1d.jl#L1-L85">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.energy_total_modified!-Tuple{Any, Any, HyperbolicSerreGreenNaghdiEquations1D, Any}" href="#DispersiveShallowWater.energy_total_modified!-Tuple{Any, Any, HyperbolicSerreGreenNaghdiEquations1D, Any}"><code>DispersiveShallowWater.energy_total_modified!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DispersiveShallowWater.energy_total_modified!(e, q_global, equations::HyperbolicSerreGreenNaghdiEquations1D, cache)</code></pre><p>Return the modified total energy <code>e</code> of the primitive variables <code>q_global</code> for the <a href="#DispersiveShallowWater.HyperbolicSerreGreenNaghdiEquations1D"><code>HyperbolicSerreGreenNaghdiEquations1D</code></a>. It contains additional terms compared to the usual <a href="#DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}"><code>energy_total</code></a> modeling non-hydrostatic contributions. The <code>energy_total_modified</code> is a conserved quantity (for periodic boundary conditions).</p><p>For a <a href="#DispersiveShallowWater.bathymetry_mild_slope"><code>bathymetry_mild_slope</code></a> (and a <a href="#DispersiveShallowWater.bathymetry_flat"><code>bathymetry_flat</code></a>), the total modified energy is given by</p><p class="math-container">\[\frac{1}{2} g \eta^2 + \frac{1}{2} h v^2 +
\frac{1}{6} h w^2 + \frac{\lambda}{6} h (1 - \eta / h)^2.\]</p><p><code>q_global</code> is a vector of the primitive variables at ALL nodes.</p><p>See also <a href="#DispersiveShallowWater.energy_total_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>energy_total_modified</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/hyperbolic_serre_green_naghdi_1d.jl#L438-L457">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, HyperbolicSerreGreenNaghdiEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, HyperbolicSerreGreenNaghdiEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_manufactured</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_manufactured(x, t, equations::HyperbolicSerreGreenNaghdiEquations1D, mesh)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMEquation1D}"><code>source_terms_manufactured</code></a>, see</p><ul><li>Hendrik Ranocha and Mario Ricchiuto (2024) Structure-preserving approximations of the Serre-Green-Naghdi equations in standard and hyperbolic form <a href="https://arxiv.org/abs/2408.02665">arXiv: 2408.02665</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/hyperbolic_serre_green_naghdi_1d.jl#L189-L198">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_soliton-Tuple{Any, Any, HyperbolicSerreGreenNaghdiEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_soliton-Tuple{Any, Any, HyperbolicSerreGreenNaghdiEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_soliton</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_soliton(x, t, equations::HyperbolicSerreGreenNaghdiEquations1D, mesh)</code></pre><p>A soliton solution of the <a href="#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a> used for convergence tests in a periodic domain. This is physically the same as <a href="#DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, BBMEquation1D, Any}"><code>initial_condition_convergence_test</code></a> for the <a href="#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a>. Please note that this is not an exact solution of the <a href="#DispersiveShallowWater.HyperbolicSerreGreenNaghdiEquations1D"><code>HyperbolicSerreGreenNaghdiEquations1D</code></a> (only in the limit of the relaxation parameter <span>$\lambda \to \infty$</span>).</p><p>See also <a href="#DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, BBMEquation1D, Any}"><code>initial_condition_convergence_test</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/hyperbolic_serre_green_naghdi_1d.jl#L153-L164">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.prim2phys-Tuple{Any, HyperbolicSerreGreenNaghdiEquations1D}" href="#DispersiveShallowWater.prim2phys-Tuple{Any, HyperbolicSerreGreenNaghdiEquations1D}"><code>DispersiveShallowWater.prim2phys</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prim2phys(q, equations::HyperbolicSerreGreenNaghdiEquations1D)</code></pre><p>Return the physical variables <span>$\eta, v, D$</span> used also by the <a href="#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a> from the main variables <code>q</code> for the <a href="#DispersiveShallowWater.HyperbolicSerreGreenNaghdiEquations1D"><code>HyperbolicSerreGreenNaghdiEquations1D</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/hyperbolic_serre_green_naghdi_1d.jl#L110-L116">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, HyperbolicSerreGreenNaghdiEquations1D}" href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, HyperbolicSerreGreenNaghdiEquations1D}"><code>DispersiveShallowWater.source_terms_manufactured</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">source_terms_manufactured(q, x, t, equations::HyperbolicSerreGreenNaghdiEquations1D, mesh)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMEquation1D, Any}"><code>initial_condition_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/hyperbolic_serre_green_naghdi_1d.jl#L213-L218">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.SerreGreenNaghdiEquations1D" href="#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>DispersiveShallowWater.SerreGreenNaghdiEquations1D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SerreGreenNaghdiEquations1D(; bathymetry_type = bathymetry_variable,
                            gravity, eta0 = 0.0)</code></pre><p>Serre-Green-Naghdi system in one spatial dimension. The equations for flat bathymetry are given by</p><p class="math-container">\[\begin{aligned}
  h_t + (h v)_x &amp;= 0,\\
  h v_t - \frac{1}{3} (h^3 v_{tx})_x + \frac{1}{2} g (h^2)_x + \frac{1}{2} h (v^2)_x + p_x &amp;= 0,\\
  p &amp;= \frac{1}{3} h^3 v_{x}^2 - \frac{1}{3} h^3 v v_{xx}.
\end{aligned}\]</p><p>The unknown quantities of the Serre-Green-Naghdi equations are the total water height <span>$\eta = h + b$</span> and the velocity <span>$v$</span>. The gravitational acceleration <code>gravity</code> is denoted by <span>$g$</span> and the bottom topography (bathymetry) <span>$b = \eta_0 - D$</span>. The water height above the bathymetry is therefore given by <span>$h = \eta - \eta_0 + D$</span>. The total water height is therefore given by <span>$\eta = h + b$</span>.</p><p>Three types of <code>bathymetry_type</code> are supported:</p><ul><li><a href="#DispersiveShallowWater.bathymetry_flat"><code>bathymetry_flat</code></a>: flat bathymetry (typically <span>$b = 0$</span> everywhere)</li><li><a href="#DispersiveShallowWater.bathymetry_mild_slope"><code>bathymetry_mild_slope</code></a>: variable bathymetry with mild-slope approximation</li><li><a href="#DispersiveShallowWater.bathymetry_variable"><code>bathymetry_variable</code></a>: general variable bathymetry</li></ul><p>For the mild-slope approximation, the Serre-Green-Naghdi equations are</p><p class="math-container">\[\begin{aligned}
  h_t + (h v)_x &amp;= 0,\\
  h v_t - \frac{1}{3} (h^3 v_{tx})_x + \frac{1}{2} (h^2 b_x v_t)_x - \frac{1}{2} h^2 b_x v_{tx} + \frac{3}{4} h b_x^2 v_t
    + \frac{1}{2} g (h^2)_x + g h b_x + \frac{1}{2} h (v^2)_x
    + p_x + \frac{3}{2} \frac{p}{h} b_x &amp;= 0,\\
  p &amp;= \frac{1}{3} h^3 v_{x}^2 - \frac{1}{3} h^3 v v_{xx}
    + \frac{1}{2} h^2 v (b_x v)_x.
\end{aligned}\]</p><p>For the general case of variable bathymetry without mild-slope approximation, the Serre-Green-Naghdi equations are</p><p class="math-container">\[\begin{aligned}
  h_t + (h v)_x &amp;= 0,\\
  h v_t - \frac{1}{3} (h^3 v_{tx})_x + \frac{1}{2} (h^2 b_x v_t)_x - \frac{1}{2} h^2 b_x v_{tx} + h b_x^2 v_t
    + \frac{1}{2} g (h^2)_x + g h b_x + \frac{1}{2} h (v^2)_x
    + p_x + \frac{3}{2} \frac{p}{h} b_x + \psi b_x &amp;= 0,\\
  p &amp;= \frac{1}{3} h^3 v_{x}^2 - \frac{1}{3} h^3 v v_{xx}
    + \frac{1}{2} h^2 v (b_x v)_x,\\
  \psi &amp;= \frac{1}{4} h v (b_x v)_x.
\end{aligned}\]</p><p>References for the Serre-Green-Naghdi system can be found in</p><ul><li>Serre (1953) Contribution â l&#39;étude des écoulements permanents et variables dans les canaux <a href="https://doi.org/10.1051/lhb/1953034">DOI: 10.1051/lhb/1953034</a></li><li>Green and Naghdi (1976) A derivation of equations for wave propagation in water of variable depth <a href="https://doi.org/10.1017/S0022112076002425">DOI: 10.1017/S0022112076002425</a></li></ul><p>The semidiscretization implemented here conserves</p><ul><li>the total water mass (integral of <span>$h$</span>) as a linear invariant</li><li>the total momentum (integral of <span>$h v$</span>) as a nonlinear invariant if the bathymetry is constant</li><li>the total modified energy</li></ul><p>for periodic boundary conditions (see Ranocha and Ricchiuto (2024)). Additionally, it is well-balanced for the lake-at-rest stationary solution, see</p><ul><li>Hendrik Ranocha and Mario Ricchiuto (2024) Structure-preserving approximations of the Serre-Green-Naghdi equations in standard and hyperbolic form <a href="https://arxiv.org/abs/2408.02665">arXiv: 2408.02665</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/serre_green_naghdi_1d.jl#L1-L70">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.energy_total_modified!-Tuple{Any, Any, SerreGreenNaghdiEquations1D, Any}" href="#DispersiveShallowWater.energy_total_modified!-Tuple{Any, Any, SerreGreenNaghdiEquations1D, Any}"><code>DispersiveShallowWater.energy_total_modified!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DispersiveShallowWater.energy_total_modified!(e, q_global, equations::SerreGreenNaghdiEquations1D, cache)</code></pre><p>Return the modified total energy <code>e</code> of the primitive variables <code>q_global</code> for the <a href="#DispersiveShallowWater.SerreGreenNaghdiEquations1D"><code>SerreGreenNaghdiEquations1D</code></a>. It contains an additional term containing a derivative compared to the usual <a href="#DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}"><code>energy_total</code></a> modeling non-hydrostatic contributions. The <code>energy_total_modified</code> is a conserved quantity (for periodic boundary conditions).</p><p>For a <a href="#DispersiveShallowWater.bathymetry_flat"><code>bathymetry_flat</code></a> the total modified energy is given by</p><p class="math-container">\[\frac{1}{2} g \eta^2 + \frac{1}{2} h v^2 + \frac{1}{6} h^3 v_x^2.\]</p><p>For a <a href="#DispersiveShallowWater.bathymetry_mild_slope"><code>bathymetry_mild_slope</code></a> the total modified energy is given by</p><p class="math-container">\[\frac{1}{2} g \eta^2 + \frac{1}{2} h v^2 + \frac{1}{6} h (-h v_x + 1.5 v b_x)^2.\]</p><p>For a <a href="#DispersiveShallowWater.bathymetry_variable"><code>bathymetry_variable</code></a> the total modified energy has the additional term</p><p class="math-container">\[+ \frac{1}{8} h (v b_x)^2.\]</p><p><code>q_global</code> is a vector of the primitive variables at ALL nodes. <code>cache</code> needs to hold the SBP operators used by the <code>solver</code>.</p><p>See also <a href="#DispersiveShallowWater.energy_total_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>energy_total_modified</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/serre_green_naghdi_1d.jl#L794-L821">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, SerreGreenNaghdiEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_convergence_test-Tuple{Any, Any, SerreGreenNaghdiEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_convergence_test</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_convergence_test(x, t, equations::SerreGreenNaghdiEquations1D, mesh)</code></pre><p>A soliton solution used for convergence tests in a periodic domain.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/serre_green_naghdi_1d.jl#L83-L87">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, SerreGreenNaghdiEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, SerreGreenNaghdiEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_manufactured</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_manufactured(x, t, equations::SerreGreenNaghdiEquations1D, mesh)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMEquation1D}"><code>source_terms_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/serre_green_naghdi_1d.jl#L105-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, SerreGreenNaghdiEquations1D{DispersiveShallowWater.BathymetryFlat}}" href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, SerreGreenNaghdiEquations1D{DispersiveShallowWater.BathymetryFlat}}"><code>DispersiveShallowWater.source_terms_manufactured</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">source_terms_manufactured(q, x, t, equations::SerreGreenNaghdiEquations1D, mesh)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMEquation1D, Any}"><code>initial_condition_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/serre_green_naghdi_1d.jl#L133-L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.SvaerdKalischEquations1D" href="#DispersiveShallowWater.SvaerdKalischEquations1D"><code>DispersiveShallowWater.SvaerdKalischEquations1D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SvaerdKalischEquations1D(; bathymetry_type = bathymetry_variable,
                         gravity, eta0 = 0.0, alpha = 0.0,
                         beta = 0.2308939393939394, gamma = 0.04034343434343434)</code></pre><p>Dispersive system by Svärd and Kalisch (2023) in one spatial dimension. The equations for variable bathymetry are given in conservative variables by</p><p class="math-container">\[\begin{aligned}
  h_t + (hv)_x &amp;= (\hat\alpha(\hat\alpha(h + b)_x)_x)_x,\\
  (hv)_t + (hv^2)_x + gh(h + b)_x &amp;= (\hat\alpha v(\hat\alpha(h + b)_x)_x)_x + (\hat\beta v_x)_{xt} + \frac{1}{2}(\hat\gamma v_x)_{xx} + \frac{1}{2}(\hat\gamma v_{xx})_x,
\end{aligned}\]</p><p>where <span>$\hat\alpha^2 = \alpha\sqrt{gD}D^2$</span>, <span>$\hat\beta = \beta D^3$</span>, <span>$\hat\gamma = \gamma\sqrt{gD}D^3$</span>. The coefficients <span>$\alpha$</span>, <span>$\beta$</span> and <span>$\gamma$</span> are provided in dimensionless form and <span>$D = \eta_0 - b$</span> is the still-water depth and <code>eta0</code> is the still-water surface (lake-at-rest). The equations can be rewritten in primitive variables as</p><p class="math-container">\[\begin{aligned}
  \eta_t + ((\eta + D)v)_x &amp;= (\hat\alpha(\hat\alpha\eta_x)_x)_x,\\
  v_t(\eta + D) - v((\eta + D)v)_x + ((\eta + D)v^2)_x + g(\eta + D)\eta_x &amp;= (\hat\alpha v(\hat\alpha\eta_x)_x)_x - v(\hat\alpha(\hat\alpha\eta_x)_x)_x + (\hat\beta v_x)_{xt} + \frac{1}{2}(\hat\gamma v_x)_{xx} + \frac{1}{2}(\hat\gamma v_{xx})_x.
\end{aligned}\]</p><p>The unknown quantities of the Svärd-Kalisch equations are the total water height <span>$\eta$</span> and the velocity <span>$v$</span>. The gravitational acceleration <code>gravity</code> is denoted by <span>$g$</span> and the bottom topography (bathymetry) <span>$b = \eta_0 - D$</span>. The water height above the bathymetry is therefore given by <span>$h = \eta - \eta_0 + D$</span>.</p><p>Currently, the equations only support a general variable bathymetry, see <a href="#DispersiveShallowWater.bathymetry_variable"><code>bathymetry_variable</code></a>.</p><p><code>SvärdKalischEquations1D</code> is an alias for <code>SvaerdKalischEquations1D</code>.</p><p>The equations by Svärd and Kalisch are presented and analyzed in Svärd and Kalisch (2023). The semidiscretization implemented here conserves</p><ul><li>the total water mass (integral of <span>$h$</span>) as a linear invariant</li><li>the total momentum (integral of <span>$h v$</span>) as a nonlinear invariant for flat bathymetry</li><li>the total modified energy</li></ul><p>for periodic boundary conditions (see Lampert, Ranocha). Additionally, it is well-balanced for the lake-at-rest stationary solution, see Lampert and Ranocha (2024).</p><ul><li>Magnus Svärd, Henrik Kalisch (2023) A novel energy-bounded Boussinesq model and a well-balanced and stable numerical discretization <a href="https://arxiv.org/abs/2302.09924">arXiv: 2302.09924</a></li><li>Joshua Lampert, Hendrik Ranocha (2024) Structure-Preserving Numerical Methods for Two Nonlinear Systems of Dispersive Wave Equations <a href="https://doi.org/10.48550/arXiv.2402.16669">DOI: 10.48550/arXiv.2402.16669</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/svaerd_kalisch_1d.jl#L1-L48">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.energy_total_modified!-Tuple{Any, Any, SvaerdKalischEquations1D, Any}" href="#DispersiveShallowWater.energy_total_modified!-Tuple{Any, Any, SvaerdKalischEquations1D, Any}"><code>DispersiveShallowWater.energy_total_modified!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DispersiveShallowWater.energy_total_modified!(e, q_global, equations::SvaerdKalischEquations1D, cache)</code></pre><p>Return the modified total energy <code>e</code> of the primitive variables <code>q_global</code> for the <a href="#DispersiveShallowWater.SvaerdKalischEquations1D"><code>SvaerdKalischEquations1D</code></a>. It contains an additional term containing a derivative compared to the usual <a href="#DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}"><code>energy_total</code></a> modeling non-hydrostatic contributions. The <code>energy_total_modified</code> is a conserved quantity (for periodic boundary conditions).</p><p>It is given by</p><p class="math-container">\[\frac{1}{2} g \eta^2 + \frac{1}{2} h v^2 + \frac{1}{2} \hat\beta v_x^2.\]</p><p><code>q_global</code> is a vector of the primitive variables at ALL nodes. <code>cache</code> needs to hold the SBP operators used by the <code>solver</code>.</p><p>See also <a href="#DispersiveShallowWater.energy_total_modified-Tuple{Any, DispersiveShallowWater.AbstractEquations, Any}"><code>energy_total_modified</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/svaerd_kalisch_1d.jl#L501-L519">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, SvaerdKalischEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, SvaerdKalischEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_manufactured</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_manufactured(x, t, equations::SvaerdKalischEquations1D, mesh)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, BBMEquation1D}"><code>source_terms_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/svaerd_kalisch_1d.jl#L67-L71">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, SvaerdKalischEquations1D, Any}" href="#DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, SvaerdKalischEquations1D, Any}"><code>DispersiveShallowWater.initial_condition_manufactured_reflecting</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">initial_condition_manufactured_reflecting(x, t, equations::SvaerdKalischEquations1D, mesh)</code></pre><p>A smooth manufactured solution for reflecting boundary conditions in combination with <a href="#DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, BBMBBMEquations1D}"><code>source_terms_manufactured_reflecting</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/svaerd_kalisch_1d.jl#L143-L148">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, SvaerdKalischEquations1D}" href="#DispersiveShallowWater.source_terms_manufactured-Tuple{Any, Any, Any, SvaerdKalischEquations1D}"><code>DispersiveShallowWater.source_terms_manufactured</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">source_terms_manufactured(q, x, t, equations::SvaerdKalischEquations1D, mesh)</code></pre><p>A smooth manufactured solution in combination with <a href="#DispersiveShallowWater.initial_condition_manufactured-Tuple{Any, Any, BBMEquation1D, Any}"><code>initial_condition_manufactured</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/svaerd_kalisch_1d.jl#L82-L86">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, SvaerdKalischEquations1D}" href="#DispersiveShallowWater.source_terms_manufactured_reflecting-Tuple{Any, Any, Any, SvaerdKalischEquations1D}"><code>DispersiveShallowWater.source_terms_manufactured_reflecting</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">source_terms_manufactured_reflecting(q, x, t, equations::SvaerdKalischEquations1D, mesh)</code></pre><p>A smooth manufactured solution for reflecting boundary conditions in combination with <a href="#DispersiveShallowWater.initial_condition_manufactured_reflecting-Tuple{Any, Any, BBMBBMEquations1D, Any}"><code>initial_condition_manufactured_reflecting</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/equations/svaerd_kalisch_1d.jl#L159-L164">source</a></section></article><h2 id="Linear-dispersion-relations"><a class="docs-heading-anchor" href="#Linear-dispersion-relations">Linear dispersion relations</a><a id="Linear-dispersion-relations-1"></a><a class="docs-heading-anchor-permalink" href="#Linear-dispersion-relations" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.EulerEquations1D" href="#DispersiveShallowWater.EulerEquations1D"><code>DispersiveShallowWater.EulerEquations1D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">EulerEquations1D(; gravity, eta0 = 0.0)</code></pre><p>A struct representing the 1D Euler equations with a given gravitational acceleration <code>gravity</code> and a still-water surface <code>eta0</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>In DispersiveShallowWater.jl, the Euler equations are <em>only</em> used for computing the full linear dispersion relation</p><p class="math-container">\[\omega(k) = \sqrt{g k \tanh(h_0 k)},\]</p><p>see <a href="#DispersiveShallowWater.LinearDispersionRelation"><code>LinearDispersionRelation</code></a> and <a href="#DispersiveShallowWater.wave_speed-Tuple{LinearDispersionRelation, Any, Any}"><code>wave_speed</code></a>. The <code>EulerEquations1D</code> cannot be solved as a system of equations.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/dispersion_relation.jl#L43-L57">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.LinearDispersionRelation" href="#DispersiveShallowWater.LinearDispersionRelation"><code>DispersiveShallowWater.LinearDispersionRelation</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">LinearDispersionRelation(ref_height)</code></pre><p>A struct representing a linear dispersion relation <span>$\omega(k)$</span> of an equation. The reference water height <span>$h_0$</span> is given by <code>ref_height</code>. A dispersion relation can be called as <code>disp_rel(equations, k)</code> to compute the wave frequency <span>$\omega(k)$</span> for a given wavenumber <code>k</code> and a set of equations.</p><p>See also <a href="#DispersiveShallowWater.wave_speed-Tuple{LinearDispersionRelation, Any, Any}"><code>wave_speed</code></a> for computing the wave speed <span>$c = \omega(k) / k$</span> given a linear dispersion relation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/dispersion_relation.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.wave_speed-Tuple{LinearDispersionRelation, Any, Any}" href="#DispersiveShallowWater.wave_speed-Tuple{LinearDispersionRelation, Any, Any}"><code>DispersiveShallowWater.wave_speed</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">wave_speed(disp_rel, equations, k; normalize = false)</code></pre><p>Compute the wave speed <span>$c$</span> for a given wavenumber <span>$k$</span> using the <a href="#DispersiveShallowWater.LinearDispersionRelation"><code>LinearDispersionRelation</code></a> <code>disp_rel</code> of the <code>equations</code>. The wave speed is given by <span>$c = \omega(k) / k$</span>. If <code>normalize</code> is <code>true</code>, the wave speed is normalized by the shallow water wave speed <span>$\sqrt{g h_0}$</span>, where <span>$g$</span> is the gravitational acceleration of the <code>equations</code> and <span>$h_0$</span> is the <code>ref_height</code> of the dispersion relation <code>disp_rel</code>.</p><p>See also <a href="#DispersiveShallowWater.LinearDispersionRelation"><code>LinearDispersionRelation</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/dispersion_relation.jl#L22-L32">source</a></section></article><h2 id="Mesh"><a class="docs-heading-anchor" href="#Mesh">Mesh</a><a id="Mesh-1"></a><a class="docs-heading-anchor-permalink" href="#Mesh" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.Mesh1D" href="#DispersiveShallowWater.Mesh1D"><code>DispersiveShallowWater.Mesh1D</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Mesh1D</code></pre><p>Struct that holds the information for a simple homogeneous one-dimensional mesh.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/mesh.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.Mesh1D-Tuple{Any, Any, Any}" href="#DispersiveShallowWater.Mesh1D-Tuple{Any, Any, Any}"><code>DispersiveShallowWater.Mesh1D</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Mesh1D(xmin, xmax, N)</code></pre><p>Create a simple homogeneous one-dimensional mesh from <code>xmin</code> to <code>xmax</code> with <code>N</code> nodes.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/mesh.jl#L18-L22">source</a></section></article><h2 id="Boundary-conditions"><a class="docs-heading-anchor" href="#Boundary-conditions">Boundary conditions</a><a id="Boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Boundary-conditions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.boundary_condition_periodic" href="#DispersiveShallowWater.boundary_condition_periodic"><code>DispersiveShallowWater.boundary_condition_periodic</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">boundary_condition_periodic = DispersiveShallowWater.BoundaryConditionPeriodic()</code></pre><p>A singleton struct indicating periodic boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/boundary_conditions.jl#L3-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.boundary_condition_reflecting" href="#DispersiveShallowWater.boundary_condition_reflecting"><code>DispersiveShallowWater.boundary_condition_reflecting</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">boundary_condition_reflecting = DispersiveShallowWater.BoundaryConditionReflecting()</code></pre><p>A singleton struct indicating reflecting boundary conditions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/boundary_conditions.jl#L13-L16">source</a></section></article><h2 id="Solver"><a class="docs-heading-anchor" href="#Solver">Solver</a><a id="Solver-1"></a><a class="docs-heading-anchor-permalink" href="#Solver" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.AbstractSolver" href="#DispersiveShallowWater.AbstractSolver"><code>DispersiveShallowWater.AbstractSolver</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AbstractSolver</code></pre><p>An abstract supertype of specific solvers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/solver.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.Solver" href="#DispersiveShallowWater.Solver"><code>DispersiveShallowWater.Solver</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Solver</code></pre><p>A <code>struct</code> that holds the summation-by-parts (SBP) operators that are used for the spatial discretization.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/solver.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.Solver-Tuple{Any, Any}" href="#DispersiveShallowWater.Solver-Tuple{Any, Any}"><code>DispersiveShallowWater.Solver</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Solver(mesh, accuracy_order)</code></pre><p>Create a solver, where the summation-by-parts (SBP) operators are of order <code>accuracy_order</code> and associated to the <code>mesh</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/solver.jl#L37-L42">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.Solver-Union{Tuple{RealT}, Tuple{SummationByPartsOperators.AbstractDerivativeOperator{RealT}, Union{Nothing, AbstractMatrix{RealT}, SummationByPartsOperators.AbstractDerivativeOperator{RealT}}}} where RealT" href="#DispersiveShallowWater.Solver-Union{Tuple{RealT}, Tuple{SummationByPartsOperators.AbstractDerivativeOperator{RealT}, Union{Nothing, AbstractMatrix{RealT}, SummationByPartsOperators.AbstractDerivativeOperator{RealT}}}} where RealT"><code>DispersiveShallowWater.Solver</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Solver(D1, D2)</code></pre><p>Create a solver, where <code>D1</code> is an <code>AbstractDerivativeOperator</code> from <a href="https://github.com/ranocha/SummationByPartsOperators.jl">SummationByPartsOperators.jl</a> of first <code>derivative_order</code> and <code>D2</code> is an <code>AbstractDerivativeOperator</code> of second <code>derivative_order</code> or an <code>AbstractMatrix</code>. It can also be <code>nothing</code> if no second derivative is used by the discretization. Both summation-by-parts operators should be associated with the same grid.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/solver.jl#L51-L60">source</a></section></article><h2 id="Semidiscretization"><a class="docs-heading-anchor" href="#Semidiscretization">Semidiscretization</a><a id="Semidiscretization-1"></a><a class="docs-heading-anchor-permalink" href="#Semidiscretization" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.Semidiscretization" href="#DispersiveShallowWater.Semidiscretization"><code>DispersiveShallowWater.Semidiscretization</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Semidiscretization</code></pre><p>A <code>struct</code> containing everything needed to describe a spatial semidiscretization of an equation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/semidiscretization.jl#L2-L7">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.Semidiscretization-NTuple{4, Any}" href="#DispersiveShallowWater.Semidiscretization-NTuple{4, Any}"><code>DispersiveShallowWater.Semidiscretization</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Semidiscretization(mesh, equations, initial_condition, solver;
                   source_terms=nothing,
                   boundary_conditions=boundary_condition_periodic,
                   RealT=real(solver),
                   uEltype=RealT,
                   initial_cache=(tmp1 = Array{RealT}(undef, nnodes(mesh)),))</code></pre><p>Construct a semidiscretization of a PDE.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/semidiscretization.jl#L43-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.jacobian-Tuple{Semidiscretization}" href="#DispersiveShallowWater.jacobian-Tuple{Semidiscretization}"><code>DispersiveShallowWater.jacobian</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">DispersiveShallowWater.jacobian(semi::Semidiscretization;
                                t = 0.0,
                                q0 = compute_coefficients(semi.initial_condition, t, semi))</code></pre><p>Use the right-hand side operator of the semidiscretization <code>semi</code> and forward mode automatic differentiation to compute the Jacobian <code>J</code> of the semidiscretization <code>semi</code> at the state <code>q0</code>.</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This functionality may not be implemented for all equations.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/semidiscretization.jl#L225-L236">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SummationByPartsOperators.grid-Tuple{Semidiscretization}" href="#SummationByPartsOperators.grid-Tuple{Semidiscretization}"><code>SummationByPartsOperators.grid</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">grid(semi)</code></pre><p>Get the grid of a semidiscretization.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/semidiscretization.jl#L114-L118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SummationByPartsOperators.semidiscretize-Tuple{Semidiscretization, Any}" href="#SummationByPartsOperators.semidiscretize-Tuple{Semidiscretization, Any}"><code>SummationByPartsOperators.semidiscretize</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">semidiscretize(semi::Semidiscretization, tspan)</code></pre><p>Wrap the semidiscretization <code>semi</code> as an ODE problem in the time interval <code>tspan</code> that can be passed to <code>solve</code> from the <a href="https://diffeq.sciml.ai/latest/">SciML ecosystem</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/semidiscretization.jl#L212-L217">source</a></section></article><h2 id="Callbacks"><a class="docs-heading-anchor" href="#Callbacks">Callbacks</a><a id="Callbacks-1"></a><a class="docs-heading-anchor-permalink" href="#Callbacks" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.AnalysisCallback" href="#DispersiveShallowWater.AnalysisCallback"><code>DispersiveShallowWater.AnalysisCallback</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AnalysisCallback(semi; interval=0,
                       extra_analysis_errors=Symbol[],
                       extra_analysis_integrals=(),
                       io=stdout)</code></pre><p>Analyze a numerical solution every <code>interval</code> time steps. The L2- and the L∞-norm for each component are computed by default. Additional errors can be computed, e.g. by passing <code>extra_analysis_errors = (:conservation_error,)</code>.</p><p>Further scalar functions <code>func</code> in <code>extra_analysis_integrals</code> are applied to the numerical solution and integrated over the computational domain. Some examples for this are <a href="#DispersiveShallowWater.entropy-Tuple{Any, AbstractShallowWaterEquations}"><code>entropy</code></a>, and <a href="#DispersiveShallowWater.energy_total-Tuple{Any, AbstractShallowWaterEquations}"><code>energy_total</code></a>. You can also write your own function with the same signature as the examples listed above and pass it via <code>extra_analysis_integrals</code>. The computed errors and intergrals are saved for each timestep and can be obtained by calling <a href="#DispersiveShallowWater.errors-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}"><code>errors</code></a> and <a href="#DispersiveShallowWater.integrals-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}"><code>integrals</code></a>.</p><p>During the Simulation, the <code>AnalysisCallback</code> will print information to <code>io</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/callbacks_step/analysis.jl#L1-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.errors-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}" href="#DispersiveShallowWater.errors-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}"><code>DispersiveShallowWater.errors</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">errors(analysis_callback)</code></pre><p>Return the computed errors for each timestep as a named tuple. The shape of each entry is (nvariables, ntimesteps).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/callbacks_step/analysis.jl#L117-L122">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.integrals-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}" href="#DispersiveShallowWater.integrals-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}"><code>DispersiveShallowWater.integrals</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">integrals(analysis_callback)</code></pre><p>Return the computed integrals for each timestep as a named tuple.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/callbacks_step/analysis.jl#L136-L140">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.tstops-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}" href="#DispersiveShallowWater.tstops-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}"><code>DispersiveShallowWater.tstops</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">tstops(analysis_callback)</code></pre><p>Return the time values that correspond to the saved values of the <a href="#DispersiveShallowWater.errors-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}"><code>errors</code></a> and <a href="#DispersiveShallowWater.integrals-Union{Tuple{SciMLBase.DiscreteCallback{Condition, Affect!}}, Tuple{Affect!}, Tuple{Condition}} where {Condition, Affect!&lt;:AnalysisCallback}"><code>integrals</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/callbacks_step/analysis.jl#L104-L108">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.RelaxationCallback" href="#DispersiveShallowWater.RelaxationCallback"><code>DispersiveShallowWater.RelaxationCallback</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">RelaxationCallback(invariant)</code></pre><p>Use a relaxation method in time in order to exactly preserve the (nonlinear) <code>invariant</code> for a conservative semidiscretization. A possible choice for <code>invariant</code> is <code>invariant = entropy</code>.</p><p>Reference</p><ul><li>Hendrik Ranocha, Mohammed Sayyari, Lisandro Dalcin, Matteo Parsani, David I. Ketcheson (2020) Relaxation Runge–Kutta Methods: Fully-Discrete Explicit Entropy-Stable Schemes for the Compressible Euler and Navier–Stokes Equations <a href="https://doi.org/10.1137/19M1263480">DOI: 10.1137/19M1263480</a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/callbacks_step/relaxation.jl#L1-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.SummaryCallback" href="#DispersiveShallowWater.SummaryCallback"><code>DispersiveShallowWater.SummaryCallback</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SummaryCallback(io::IO = stdout)</code></pre><p>Create and return a callback that resets the timer at the beginning of a simulation and prints the timer values at the end of the simulation.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/callbacks_step/summary.jl#L1-L6">source</a></section></article><h2 id="Utilities"><a class="docs-heading-anchor" href="#Utilities">Utilities</a><a id="Utilities-1"></a><a class="docs-heading-anchor-permalink" href="#Utilities" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.convergence_test-Tuple{Module, AbstractString, Any}" href="#DispersiveShallowWater.convergence_test-Tuple{Module, AbstractString, Any}"><code>DispersiveShallowWater.convergence_test</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">convergence_test([mod::Module=Main,] example::AbstractString, iterations; io::IO = stdout, kwargs...)
convergence_test([mod::Module=Main,] example::AbstractString, Ns::AbstractVector; io::IO = stdout, kwargs...)</code></pre><p>Run multiple simulations using the setup given in <code>example</code> and compute the experimental order of convergence (EOC) in the <span>$L^2$</span> and <span>$L^\infty$</span> norm. If <code>iterations</code> is passed as integer, in each iteration, the resolution of the respective mesh will be doubled. If <code>Ns</code> is passed as vector, the simulations will be run for each value of <code>Ns</code>. Additional keyword arguments <code>kwargs...</code> and the optional module <code>mod</code> are passed directly to <a href="../ref-trixibase/#TrixiBase.trixi_include-Tuple{Function, Module, AbstractString}"><code>trixi_include</code></a>.</p><p>Adjusted from <a href="https://github.com/trixi-framework/Trixi.jl">Trixi.jl</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/util.jl#L54-L66">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.default_example-Tuple{}" href="#DispersiveShallowWater.default_example-Tuple{}"><code>DispersiveShallowWater.default_example</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">default_example()</code></pre><p>Return the path to an example that can be used to quickly see DispersiveShallowWater.jl in action. See also <a href="#DispersiveShallowWater.examples_dir-Tuple{}"><code>examples_dir</code></a> and <a href="#DispersiveShallowWater.get_examples-Tuple{}"><code>get_examples</code></a>.</p><p>Copied from <a href="https://github.com/trixi-framework/Trixi.jl">Trixi.jl</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/util.jl#L38-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.examples_dir-Tuple{}" href="#DispersiveShallowWater.examples_dir-Tuple{}"><code>DispersiveShallowWater.examples_dir</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">examples_dir()</code></pre><p>Return the directory where the example files provided with DispersiveShallowWater.jl are located. If DispersiveShallowWater is installed as a regular package (with <code>]add DispersiveShallowWater</code>), these files are read-only and should <em>not</em> be modified. To find out which files are available, use, e.g., <code>readdir</code>.</p><p>Copied from <a href="https://github.com/trixi-framework/Trixi.jl">Trixi.jl</a>.</p><p><strong>Examples</strong></p><pre><code class="language- hljs">readdir(examples_dir())</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/util.jl#L1-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.get_examples-Tuple{}" href="#DispersiveShallowWater.get_examples-Tuple{}"><code>DispersiveShallowWater.get_examples</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_examples()</code></pre><p>Return a list of all examples that are provided by DispersiveShallowWater.jl. See also <a href="#DispersiveShallowWater.examples_dir-Tuple{}"><code>examples_dir</code></a> and <a href="#DispersiveShallowWater.default_example-Tuple{}"><code>default_example</code></a>.</p><p>Copied from <a href="https://github.com/trixi-framework/Trixi.jl">Trixi.jl</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/util.jl#L17-L24">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="DispersiveShallowWater.@autoinfiltrate" href="#DispersiveShallowWater.@autoinfiltrate"><code>DispersiveShallowWater.@autoinfiltrate</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@autoinfiltrate
@autoinfiltrate condition::Bool</code></pre><p>Invoke the <code>@infiltrate</code> macro of the package Infiltrator.jl to create a breakpoint for ad-hoc interactive debugging in the REPL. If the optional argument <code>condition</code> is given, the breakpoint is only enabled if <code>condition</code> evaluates to <code>true</code>.</p><p>As opposed to using <code>Infiltrator.@infiltrate</code> directly, this macro does not require Infiltrator.jl to be added as a dependency to DispersiveShallowWater.jl. As a bonus, the macro will also attempt to load the Infiltrator module if it has not yet been loaded manually.</p><p>Note: For this macro to work, the Infiltrator.jl package needs to be installed in your current Julia environment stack.</p><p>See also: <a href="https://github.com/JuliaDebug/Infiltrator.jl">Infiltrator.jl</a></p><div class="admonition is-warning"><header class="admonition-header">Internal use only</header><div class="admonition-body"><p>Please note that this macro is intended for internal use only. It is <em>not</em> part of the public API of DispersiveShallowWater.jl, and it thus can altered (or be removed) at any time without it being considered a breaking change.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/NumericalMathematics/DispersiveShallowWater.jl/blob/1f00fc71faa7d64637217741f923c9ffb8527a8d/src/util.jl#L193-L214">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ref-trixibase/">« TrixiBase</a><a class="docs-footer-nextpage" href="../changelog/">Changelog »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.2 on <span class="colophon-date" title="Saturday 3 May 2025 08:19">Saturday 3 May 2025</span>. Using Julia version 1.10.9.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
